
c199-031:30852:30852 [1] misc/cudawrap.cc:166 NCCL WARN cuDriverGetVersion failed with 34
c199-031:30852:30852 [1] NCCL INFO Bootstrap : Using ib0:192.168.44.171<0>
c199-031:30852:30852 [1] NCCL INFO NET/Plugin : Plugin load (libnccl-net.so) returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory
c199-031:30852:30852 [1] NCCL INFO NET/Plugin : No plugin found, using internal implementation
c199-031:30852:30895 [1] NCCL INFO NET/IB : Using [0]mlx4_0:1/IB [RO]; OOB ib0:192.168.44.171<0>
c199-031:30852:30895 [1] NCCL INFO Using network IB
c199-031:30852:30895 [1] NCCL INFO Setting affinity for GPU 1 to f000f0
c199-031:30852:30895 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
c199-031:30852:30895 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
c199-031:30852:30895 [1] NCCL INFO Trees [0] 2/-1/-1->1->0
c199-031:30852:30895 [1] NCCL INFO P2P Chunksize set to 131072
c199-031:30852:30895 [1] NCCL INFO Channel 00 : 1[3000] -> 2[82000] via SHM/direct/direct
c199-031:30852:30895 [1] NCCL INFO Connected all rings
c199-031:30852:30895 [1] NCCL INFO Channel 00 : 1[3000] -> 0[2000] via SHM/direct/direct
c199-031:30852:30895 [1] NCCL INFO Connected all trees
c199-031:30852:30895 [1] NCCL INFO NCCL_PROTO set by environment to Simple
c199-031:30852:30895 [1] NCCL INFO NCCL_ALGO set by environment to Tree
c199-031:30852:30895 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
c199-031:30852:30895 [1] NCCL INFO 1 coll channels, 0 nvls channels, 1 p2p channels, 1 p2p channels per peer
c199-031:30852:30895 [1] NCCL INFO comm 0x8d52a80 rank 1 nranks 16 cudaDev 1 busId 3000 commId 0x9434b0de62e950de - Init COMPLETE
ncclGroupEnd() finished
cudaHostAlloc() finished
ncclTestEngine() start
TimeTest start
before BenchTime()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 0
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 0
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 0
In RoleWaitSend, the *connStepPtr is: 0
userBuff in setDataPtrs is: 0x2b32dae00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 0, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 0, step is: 0, StepPerSlice is: 1, connStepPtr is: 0
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 1, step is: 0, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 1, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 1, step is: 1, StepPerSlice is: 1, connStepPtr is: 1
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 2, step is: 1, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 2, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 2, step is: 2, StepPerSlice is: 1, connStepPtr is: 3
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 3, step is: 2, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 3, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 3, step is: 3, StepPerSlice is: 1, connStepPtr is: 4
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 4, step is: 3, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 4, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 4, step is: 4, StepPerSlice is: 1, connStepPtr is: 5
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 5, step is: 4, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 5, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 5, step is: 5, StepPerSlice is: 1, connStepPtr is: 7
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 7, step is: 5, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 6, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 7, step is: 6, StepPerSlice is: 1, connStepPtr is: 8
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 7, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 7, step is: 7, StepPerSlice is: 1, connStepPtr is: 9
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 9, step is: 7, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 8, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 9, step is: 8, StepPerSlice is: 1, connStepPtr is: 10
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 1, step is: 9, StepPerSlice is: 1, connStepPtr is: 1
index is: 0, now is recv, connStepCache is: 9, step is: 9, StepPerSlice is: 1, connStepPtr is: 11
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 11, step is: 9, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 2, step is: 10, StepPerSlice is: 1, connStepPtr is: 2
index is: 0, now is recv, connStepCache is: 11, step is: 10, StepPerSlice is: 1, connStepPtr is: 12
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 3, step is: 11, StepPerSlice is: 1, connStepPtr is: 3
index is: 0, now is recv, connStepCache is: 11, step is: 11, StepPerSlice is: 1, connStepPtr is: 14
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 14, step is: 11, StepPerSlice is: 1
before startColl() in BenchTest()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before cudaLaunchKernel() 
cudaLaunchKernel() finished
after startColl() in BenchTest()
after completeColl() in BenchTest()
after args->collTest->getBw and before barrier()
after args->collTest->getBw and barrier()
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 4, step is: 12, StepPerSlice is: 1, connStepPtr is: 4
index is: 0, now is recv, connStepCache is: 14, step is: 12, StepPerSlice is: 1, connStepPtr is: 16
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 5, step is: 13, StepPerSlice is: 1, connStepPtr is: 5
index is: 0, now is recv, connStepCache is: 14, step is: 13, StepPerSlice is: 1, connStepPtr is: 16
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 6, step is: 14, StepPerSlice is: 1, connStepPtr is: 6
index is: 0, now is recv, connStepCache is: 14, step is: 14, StepPerSlice is: 1, connStepPtr is: 16
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 16, step is: 14, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 15, StepPerSlice is: 1, connStepPtr is: 7
index is: 0, now is recv, connStepCache is: 16, step is: 15, StepPerSlice is: 1, connStepPtr is: 16
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 0
In RolePostRecv, the *connStepPtr is: 0
In RoleWaitSend, the *connStepPtr is: 0
In RolePostSend, the *connStepPtr is: 0
userBuff in setDataPtrs is: 0x2b32dae00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 0, StepPerSlice is: 1, connStepPtr is: 0
index is: 0, now is recv, connStepCache is: 0, step is: 0, StepPerSlice is: 1, connStepPtr is: 0
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 1, step is: 0, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 1, StepPerSlice is: 1, connStepPtr is: 1
index is: 0, now is recv, connStepCache is: 1, step is: 1, StepPerSlice is: 1, connStepPtr is: 2
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 2, step is: 1, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 2, StepPerSlice is: 1, connStepPtr is: 2
index is: 0, now is recv, connStepCache is: 2, step is: 2, StepPerSlice is: 1, connStepPtr is: 3
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 3, step is: 2, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 3, StepPerSlice is: 1, connStepPtr is: 3
index is: 0, now is recv, connStepCache is: 3, step is: 3, StepPerSlice is: 1, connStepPtr is: 4
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 5, step is: 3, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 4, StepPerSlice is: 1, connStepPtr is: 4
index is: 0, now is recv, connStepCache is: 5, step is: 4, StepPerSlice is: 1, connStepPtr is: 6
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 5, StepPerSlice is: 1, connStepPtr is: 4
index is: 0, now is recv, connStepCache is: 5, step is: 5, StepPerSlice is: 1, connStepPtr is: 7
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 7, step is: 5, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 6, StepPerSlice is: 1, connStepPtr is: 5
index is: 0, now is recv, connStepCache is: 7, step is: 6, StepPerSlice is: 1, connStepPtr is: 8
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 7, StepPerSlice is: 1, connStepPtr is: 6
index is: 0, now is recv, connStepCache is: 7, step is: 7, StepPerSlice is: 1, connStepPtr is: 9
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 9, step is: 7, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 0, step is: 8, StepPerSlice is: 1, connStepPtr is: 7
index is: 0, now is recv, connStepCache is: 9, step is: 8, StepPerSlice is: 1, connStepPtr is: 11
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 9, StepPerSlice is: 1, connStepPtr is: 8
index is: 0, now is recv, connStepCache is: 9, step is: 9, StepPerSlice is: 1, connStepPtr is: 12
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 12, step is: 9, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 10, StepPerSlice is: 1, connStepPtr is: 9
index is: 0, now is recv, connStepCache is: 12, step is: 10, StepPerSlice is: 1, connStepPtr is: 13
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 11, StepPerSlice is: 1, connStepPtr is: 9
index is: 0, now is recv, connStepCache is: 12, step is: 11, StepPerSlice is: 1, connStepPtr is: 14
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 12, StepPerSlice is: 1, connStepPtr is: 10
index is: 0, now is recv, connStepCache is: 12, step is: 12, StepPerSlice is: 1, connStepPtr is: 15
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 15, step is: 12, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 13, StepPerSlice is: 1, connStepPtr is: 11
index is: 0, now is recv, connStepCache is: 15, step is: 13, StepPerSlice is: 1, connStepPtr is: 16
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 14, StepPerSlice is: 1, connStepPtr is: 12
index is: 0, now is recv, connStepCache is: 15, step is: 14, StepPerSlice is: 1, connStepPtr is: 16
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 7, step is: 15, StepPerSlice is: 1, connStepPtr is: 13
index is: 0, now is recv, connStepCache is: 15, step is: 15, StepPerSlice is: 1, connStepPtr is: 16
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 16, step is: 15, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 16
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 16
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 16
In RoleWaitSend, the *connStepPtr is: 16
userBuff in setDataPtrs is: 0x2b32dae00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 16, StepPerSlice is: 1, connStepPtr is: 16
index is: 0, now is recv, connStepCache is: 16, step is: 16, StepPerSlice is: 1, connStepPtr is: 16
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 17, step is: 16, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 17, StepPerSlice is: 1, connStepPtr is: 16
index is: 0, now is recv, connStepCache is: 17, step is: 17, StepPerSlice is: 1, connStepPtr is: 17
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 18, step is: 17, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 18, StepPerSlice is: 1, connStepPtr is: 17
index is: 0, now is recv, connStepCache is: 18, step is: 18, StepPerSlice is: 1, connStepPtr is: 19
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 19, step is: 18, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 19, StepPerSlice is: 1, connStepPtr is: 17
index is: 0, now is recv, connStepCache is: 19, step is: 19, StepPerSlice is: 1, connStepPtr is: 20
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 20, step is: 19, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 20, StepPerSlice is: 1, connStepPtr is: 18
index is: 0, now is recv, connStepCache is: 20, step is: 20, StepPerSlice is: 1, connStepPtr is: 21
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 21, step is: 20, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 21, StepPerSlice is: 1, connStepPtr is: 19
index is: 0, now is recv, connStepCache is: 21, step is: 21, StepPerSlice is: 1, connStepPtr is: 23
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 23, step is: 21, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 22, StepPerSlice is: 1, connStepPtr is: 19
index is: 0, now is recv, connStepCache is: 23, step is: 22, StepPerSlice is: 1, connStepPtr is: 23
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 23, StepPerSlice is: 1, connStepPtr is: 20
index is: 0, now is recv, connStepCache is: 23, step is: 23, StepPerSlice is: 1, connStepPtr is: 25
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 25, step is: 23, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 24, StepPerSlice is: 1, connStepPtr is: 21
index is: 0, now is recv, connStepCache is: 25, step is: 24, StepPerSlice is: 1, connStepPtr is: 26
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 21, step is: 25, StepPerSlice is: 1, connStepPtr is: 21
index is: 0, now is recv, connStepCache is: 25, step is: 25, StepPerSlice is: 1, connStepPtr is: 27
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 27, step is: 25, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 21, step is: 26, StepPerSlice is: 1, connStepPtr is: 22
index is: 0, now is recv, connStepCache is: 27, step is: 26, StepPerSlice is: 1, connStepPtr is: 28
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 21, step is: 27, StepPerSlice is: 1, connStepPtr is: 22
index is: 0, now is recv, connStepCache is: 27, step is: 27, StepPerSlice is: 1, connStepPtr is: 29
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 29, step is: 27, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 21, step is: 28, StepPerSlice is: 1, connStepPtr is: 23
index is: 0, now is recv, connStepCache is: 29, step is: 28, StepPerSlice is: 1, connStepPtr is: 30
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 21, step is: 29, StepPerSlice is: 1, connStepPtr is: 24
index is: 0, now is recv, connStepCache is: 29, step is: 29, StepPerSlice is: 1, connStepPtr is: 31
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 31, step is: 29, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 24, step is: 30, StepPerSlice is: 1, connStepPtr is: 24
index is: 0, now is recv, connStepCache is: 31, step is: 30, StepPerSlice is: 1, connStepPtr is: 32
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 24, step is: 31, StepPerSlice is: 1, connStepPtr is: 25
index is: 0, now is recv, connStepCache is: 31, step is: 31, StepPerSlice is: 1, connStepPtr is: 32
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 32, step is: 31, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 16
In RolePostRecv, the *connStepPtr is: 16
In RoleWaitSend, the *connStepPtr is: 16
In RolePostSend, the *connStepPtr is: 16
userBuff in setDataPtrs is: 0x2b32dae00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 16, StepPerSlice is: 1, connStepPtr is: 16
index is: 0, now is recv, connStepCache is: 16, step is: 16, StepPerSlice is: 1, connStepPtr is: 16
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 17, step is: 16, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 17, StepPerSlice is: 1, connStepPtr is: 17
index is: 0, now is recv, connStepCache is: 17, step is: 17, StepPerSlice is: 1, connStepPtr is: 18
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 18, step is: 17, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 18, StepPerSlice is: 1, connStepPtr is: 18
index is: 0, now is recv, connStepCache is: 18, step is: 18, StepPerSlice is: 1, connStepPtr is: 19
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 19, step is: 18, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 19, StepPerSlice is: 1, connStepPtr is: 19
index is: 0, now is recv, connStepCache is: 19, step is: 19, StepPerSlice is: 1, connStepPtr is: 20
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 21, step is: 19, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 20, StepPerSlice is: 1, connStepPtr is: 20
index is: 0, now is recv, connStepCache is: 21, step is: 20, StepPerSlice is: 1, connStepPtr is: 22
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 21, StepPerSlice is: 1, connStepPtr is: 20
index is: 0, now is recv, connStepCache is: 21, step is: 21, StepPerSlice is: 1, connStepPtr is: 23
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 23, step is: 21, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 22, StepPerSlice is: 1, connStepPtr is: 21
index is: 0, now is recv, connStepCache is: 23, step is: 22, StepPerSlice is: 1, connStepPtr is: 24
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 23, StepPerSlice is: 1, connStepPtr is: 22
index is: 0, now is recv, connStepCache is: 23, step is: 23, StepPerSlice is: 1, connStepPtr is: 25
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 25, step is: 23, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 16, step is: 24, StepPerSlice is: 1, connStepPtr is: 23
index is: 0, now is recv, connStepCache is: 25, step is: 24, StepPerSlice is: 1, connStepPtr is: 27
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 25, StepPerSlice is: 1, connStepPtr is: 24
index is: 0, now is recv, connStepCache is: 25, step is: 25, StepPerSlice is: 1, connStepPtr is: 28
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 28, step is: 25, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 26, StepPerSlice is: 1, connStepPtr is: 25
index is: 0, now is recv, connStepCache is: 28, step is: 26, StepPerSlice is: 1, connStepPtr is: 29
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 27, StepPerSlice is: 1, connStepPtr is: 26
index is: 0, now is recv, connStepCache is: 28, step is: 27, StepPerSlice is: 1, connStepPtr is: 30
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 28, StepPerSlice is: 1, connStepPtr is: 27
index is: 0, now is recv, connStepCache is: 28, step is: 28, StepPerSlice is: 1, connStepPtr is: 31
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 31, step is: 28, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 29, StepPerSlice is: 1, connStepPtr is: 28
index is: 0, now is recv, connStepCache is: 31, step is: 29, StepPerSlice is: 1, connStepPtr is: 32
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 30, StepPerSlice is: 1, connStepPtr is: 28
index is: 0, now is recv, connStepCache is: 31, step is: 30, StepPerSlice is: 1, connStepPtr is: 32
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 23, step is: 31, StepPerSlice is: 1, connStepPtr is: 29
index is: 0, now is recv, connStepCache is: 31, step is: 31, StepPerSlice is: 1, connStepPtr is: 32
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 32, step is: 31, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 32
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 32
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 32
In RoleWaitSend, the *connStepPtr is: 32
userBuff in setDataPtrs is: 0x2b32dae00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 32, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 32, step is: 32, StepPerSlice is: 1, connStepPtr is: 32
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 33, step is: 32, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 33, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 33, step is: 33, StepPerSlice is: 1, connStepPtr is: 33
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 34, step is: 33, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 34, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 34, step is: 34, StepPerSlice is: 1, connStepPtr is: 35
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 35, step is: 34, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 35, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 35, step is: 35, StepPerSlice is: 1, connStepPtr is: 36
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 36, step is: 35, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 36, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 36, step is: 36, StepPerSlice is: 1, connStepPtr is: 37
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 37, step is: 36, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 37, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 37, step is: 37, StepPerSlice is: 1, connStepPtr is: 39
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 39, step is: 37, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 38, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 39, step is: 38, StepPerSlice is: 1, connStepPtr is: 40
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 39, StepPerSlice is: 1, connStepPtr is: 33
index is: 0, now is recv, connStepCache is: 39, step is: 39, StepPerSlice is: 1, connStepPtr is: 41
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 41, step is: 39, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 40, StepPerSlice is: 1, connStepPtr is: 33
index is: 0, now is recv, connStepCache is: 41, step is: 40, StepPerSlice is: 1, connStepPtr is: 42
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 34, step is: 41, StepPerSlice is: 1, connStepPtr is: 34
index is: 0, now is recv, connStepCache is: 41, step is: 41, StepPerSlice is: 1, connStepPtr is: 43
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 43, step is: 41, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 34, step is: 42, StepPerSlice is: 1, connStepPtr is: 35
index is: 0, now is recv, connStepCache is: 43, step is: 42, StepPerSlice is: 1, connStepPtr is: 44
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 35, step is: 43, StepPerSlice is: 1, connStepPtr is: 35
index is: 0, now is recv, connStepCache is: 43, step is: 43, StepPerSlice is: 1, connStepPtr is: 45
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 45, step is: 43, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 36, step is: 44, StepPerSlice is: 1, connStepPtr is: 36
index is: 0, now is recv, connStepCache is: 45, step is: 44, StepPerSlice is: 1, connStepPtr is: 46
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 37, step is: 45, StepPerSlice is: 1, connStepPtr is: 37
index is: 0, now is recv, connStepCache is: 45, step is: 45, StepPerSlice is: 1, connStepPtr is: 48
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 48, step is: 45, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 38, step is: 46, StepPerSlice is: 1, connStepPtr is: 38
index is: 0, now is recv, connStepCache is: 48, step is: 46, StepPerSlice is: 1, connStepPtr is: 48
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 47, StepPerSlice is: 1, connStepPtr is: 39
index is: 0, now is recv, connStepCache is: 48, step is: 47, StepPerSlice is: 1, connStepPtr is: 48
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 32
In RolePostRecv, the *connStepPtr is: 32
In RoleWaitSend, the *connStepPtr is: 32
In RolePostSend, the *connStepPtr is: 32
userBuff in setDataPtrs is: 0x2b32dae00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 32, StepPerSlice is: 1, connStepPtr is: 32
index is: 0, now is recv, connStepCache is: 32, step is: 32, StepPerSlice is: 1, connStepPtr is: 32
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 33, step is: 32, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 33, StepPerSlice is: 1, connStepPtr is: 33
index is: 0, now is recv, connStepCache is: 33, step is: 33, StepPerSlice is: 1, connStepPtr is: 34
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 34, step is: 33, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 34, StepPerSlice is: 1, connStepPtr is: 34
index is: 0, now is recv, connStepCache is: 34, step is: 34, StepPerSlice is: 1, connStepPtr is: 35
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 35, step is: 34, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 35, StepPerSlice is: 1, connStepPtr is: 35
index is: 0, now is recv, connStepCache is: 35, step is: 35, StepPerSlice is: 1, connStepPtr is: 37
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 37, step is: 35, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 36, StepPerSlice is: 1, connStepPtr is: 36
index is: 0, now is recv, connStepCache is: 37, step is: 36, StepPerSlice is: 1, connStepPtr is: 38
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 37, StepPerSlice is: 1, connStepPtr is: 36
index is: 0, now is recv, connStepCache is: 37, step is: 37, StepPerSlice is: 1, connStepPtr is: 39
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 39, step is: 37, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 38, StepPerSlice is: 1, connStepPtr is: 37
index is: 0, now is recv, connStepCache is: 39, step is: 38, StepPerSlice is: 1, connStepPtr is: 40
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 39, StepPerSlice is: 1, connStepPtr is: 38
index is: 0, now is recv, connStepCache is: 39, step is: 39, StepPerSlice is: 1, connStepPtr is: 41
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 41, step is: 39, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 32, step is: 40, StepPerSlice is: 1, connStepPtr is: 39
index is: 0, now is recv, connStepCache is: 41, step is: 40, StepPerSlice is: 1, connStepPtr is: 43
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 41, StepPerSlice is: 1, connStepPtr is: 40
index is: 0, now is recv, connStepCache is: 41, step is: 41, StepPerSlice is: 1, connStepPtr is: 44
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 44, step is: 41, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 42, StepPerSlice is: 1, connStepPtr is: 41
index is: 0, now is recv, connStepCache is: 44, step is: 42, StepPerSlice is: 1, connStepPtr is: 45
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 43, StepPerSlice is: 1, connStepPtr is: 42
index is: 0, now is recv, connStepCache is: 44, step is: 43, StepPerSlice is: 1, connStepPtr is: 46
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 44, StepPerSlice is: 1, connStepPtr is: 43
index is: 0, now is recv, connStepCache is: 44, step is: 44, StepPerSlice is: 1, connStepPtr is: 47
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 47, step is: 44, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 45, StepPerSlice is: 1, connStepPtr is: 44
index is: 0, now is recv, connStepCache is: 47, step is: 45, StepPerSlice is: 1, connStepPtr is: 48
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 46, StepPerSlice is: 1, connStepPtr is: 45
index is: 0, now is recv, connStepCache is: 47, step is: 46, StepPerSlice is: 1, connStepPtr is: 48
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 39, step is: 47, StepPerSlice is: 1, connStepPtr is: 45
index is: 0, now is recv, connStepCache is: 47, step is: 47, StepPerSlice is: 1, connStepPtr is: 48
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 48, step is: 47, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 48
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 48
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 48
In RoleWaitSend, the *connStepPtr is: 48
userBuff in setDataPtrs is: 0x2b32dae00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 48, StepPerSlice is: 1, connStepPtr is: 48
index is: 0, now is recv, connStepCache is: 48, step is: 48, StepPerSlice is: 1, connStepPtr is: 48
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 49, step is: 48, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 49, StepPerSlice is: 1, connStepPtr is: 48
index is: 0, now is recv, connStepCache is: 49, step is: 49, StepPerSlice is: 1, connStepPtr is: 50
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 50, step is: 49, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 50, StepPerSlice is: 1, connStepPtr is: 48
index is: 0, now is recv, connStepCache is: 50, step is: 50, StepPerSlice is: 1, connStepPtr is: 51
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 51, step is: 50, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 51, StepPerSlice is: 1, connStepPtr is: 49
index is: 0, now is recv, connStepCache is: 51, step is: 51, StepPerSlice is: 1, connStepPtr is: 52
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 52, step is: 51, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 52, StepPerSlice is: 1, connStepPtr is: 50
index is: 0, now is recv, connStepCache is: 52, step is: 52, StepPerSlice is: 1, connStepPtr is: 54
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 54, step is: 52, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 53, StepPerSlice is: 1, connStepPtr is: 50
index is: 0, now is recv, connStepCache is: 54, step is: 53, StepPerSlice is: 1, connStepPtr is: 55
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 54, StepPerSlice is: 1, connStepPtr is: 51
index is: 0, now is recv, connStepCache is: 54, step is: 54, StepPerSlice is: 1, connStepPtr is: 56
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 56, step is: 54, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 55, StepPerSlice is: 1, connStepPtr is: 52
index is: 0, now is recv, connStepCache is: 56, step is: 55, StepPerSlice is: 1, connStepPtr is: 57
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 56, StepPerSlice is: 1, connStepPtr is: 52
index is: 0, now is recv, connStepCache is: 56, step is: 56, StepPerSlice is: 1, connStepPtr is: 58
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 58, step is: 56, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 52, step is: 57, StepPerSlice is: 1, connStepPtr is: 53
index is: 0, now is recv, connStepCache is: 58, step is: 57, StepPerSlice is: 1, connStepPtr is: 59
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 52, step is: 58, StepPerSlice is: 1, connStepPtr is: 54
index is: 0, now is recv, connStepCache is: 58, step is: 58, StepPerSlice is: 1, connStepPtr is: 60
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 60, step is: 58, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 52, step is: 59, StepPerSlice is: 1, connStepPtr is: 54
index is: 0, now is recv, connStepCache is: 60, step is: 59, StepPerSlice is: 1, connStepPtr is: 61
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 52, step is: 60, StepPerSlice is: 1, connStepPtr is: 55
index is: 0, now is recv, connStepCache is: 60, step is: 60, StepPerSlice is: 1, connStepPtr is: 62
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 62, step is: 60, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 61, StepPerSlice is: 1, connStepPtr is: 56
index is: 0, now is recv, connStepCache is: 62, step is: 61, StepPerSlice is: 1, connStepPtr is: 64
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 62, StepPerSlice is: 1, connStepPtr is: 56
index is: 0, now is recv, connStepCache is: 62, step is: 62, StepPerSlice is: 1, connStepPtr is: 64
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 64, step is: 62, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 63, StepPerSlice is: 1, connStepPtr is: 57
index is: 0, now is recv, connStepCache is: 64, step is: 63, StepPerSlice is: 1, connStepPtr is: 64
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 48
In RolePostRecv, the *connStepPtr is: 48
In RoleWaitSend, the *connStepPtr is: 48
In RolePostSend, the *connStepPtr is: 48
userBuff in setDataPtrs is: 0x2b32dae00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 48, StepPerSlice is: 1, connStepPtr is: 48
index is: 0, now is recv, connStepCache is: 48, step is: 48, StepPerSlice is: 1, connStepPtr is: 48
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 49, step is: 48, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 49, StepPerSlice is: 1, connStepPtr is: 49
index is: 0, now is recv, connStepCache is: 49, step is: 49, StepPerSlice is: 1, connStepPtr is: 50
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 50, step is: 49, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 50, StepPerSlice is: 1, connStepPtr is: 50
index is: 0, now is recv, connStepCache is: 50, step is: 50, StepPerSlice is: 1, connStepPtr is: 51
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 51, step is: 50, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 51, StepPerSlice is: 1, connStepPtr is: 51
index is: 0, now is recv, connStepCache is: 51, step is: 51, StepPerSlice is: 1, connStepPtr is: 52
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 52, step is: 51, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 52, StepPerSlice is: 1, connStepPtr is: 52
index is: 0, now is recv, connStepCache is: 52, step is: 52, StepPerSlice is: 1, connStepPtr is: 54
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 54, step is: 52, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 53, StepPerSlice is: 1, connStepPtr is: 53
index is: 0, now is recv, connStepCache is: 54, step is: 53, StepPerSlice is: 1, connStepPtr is: 55
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 54, StepPerSlice is: 1, connStepPtr is: 53
index is: 0, now is recv, connStepCache is: 54, step is: 54, StepPerSlice is: 1, connStepPtr is: 56
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 56, step is: 54, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 55, StepPerSlice is: 1, connStepPtr is: 54
index is: 0, now is recv, connStepCache is: 56, step is: 55, StepPerSlice is: 1, connStepPtr is: 57
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 48, step is: 56, StepPerSlice is: 1, connStepPtr is: 55
index is: 0, now is recv, connStepCache is: 56, step is: 56, StepPerSlice is: 1, connStepPtr is: 58
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 58, step is: 56, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 57, StepPerSlice is: 1, connStepPtr is: 56
index is: 0, now is recv, connStepCache is: 58, step is: 57, StepPerSlice is: 1, connStepPtr is: 60
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 58, StepPerSlice is: 1, connStepPtr is: 57
index is: 0, now is recv, connStepCache is: 58, step is: 58, StepPerSlice is: 1, connStepPtr is: 60
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 61, step is: 58, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 59, StepPerSlice is: 1, connStepPtr is: 58
index is: 0, now is recv, connStepCache is: 61, step is: 59, StepPerSlice is: 1, connStepPtr is: 62
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 60, StepPerSlice is: 1, connStepPtr is: 59
index is: 0, now is recv, connStepCache is: 61, step is: 60, StepPerSlice is: 1, connStepPtr is: 63
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 61, StepPerSlice is: 1, connStepPtr is: 60
index is: 0, now is recv, connStepCache is: 61, step is: 61, StepPerSlice is: 1, connStepPtr is: 64
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 64, step is: 61, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 62, StepPerSlice is: 1, connStepPtr is: 61
index is: 0, now is recv, connStepCache is: 64, step is: 62, StepPerSlice is: 1, connStepPtr is: 64
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 55, step is: 63, StepPerSlice is: 1, connStepPtr is: 62
index is: 0, now is recv, connStepCache is: 64, step is: 63, StepPerSlice is: 1, connStepPtr is: 64
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before startColl() in BenchTest()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before cudaLaunchKernel() 
cudaLaunchKernel() finished
after startColl() in BenchTest()
after completeColl() in BenchTest()
after args->collTest->getBw and before barrier()
after args->collTest->getBw and barrier()
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 64
NCCL_MAX_DEV_ARITY is: 2
In RolePostSend, the *connStepPtr is: 64
tee->[2] is: -1
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 64
In RoleWaitSend, the *connStepPtr is: 64
userBuff in setDataPtrs is: 0x2b32daf00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 64, StepPerSlice is: 1, connStepPtr is: 64
index is: 0, now is recv, connStepCache is: 64, step is: 64, StepPerSlice is: 1, connStepPtr is: 64
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 65, step is: 64, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 65, StepPerSlice is: 1, connStepPtr is: 64
index is: 0, now is recv, connStepCache is: 65, step is: 65, StepPerSlice is: 1, connStepPtr is: 65
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 66, step is: 65, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 66, StepPerSlice is: 1, connStepPtr is: 64
index is: 0, now is recv, connStepCache is: 66, step is: 66, StepPerSlice is: 1, connStepPtr is: 67
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 67, step is: 66, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 67, StepPerSlice is: 1, connStepPtr is: 65
index is: 0, now is recv, connStepCache is: 67, step is: 67, StepPerSlice is: 1, connStepPtr is: 68
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 68, step is: 67, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 68, StepPerSlice is: 1, connStepPtr is: 66
index is: 0, now is recv, connStepCache is: 68, step is: 68, StepPerSlice is: 1, connStepPtr is: 69
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 69, step is: 68, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 69, StepPerSlice is: 1, connStepPtr is: 66
index is: 0, now is recv, connStepCache is: 69, step is: 69, StepPerSlice is: 1, connStepPtr is: 70
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 70, step is: 69, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 70, StepPerSlice is: 1, connStepPtr is: 67
index is: 0, now is recv, connStepCache is: 70, step is: 70, StepPerSlice is: 1, connStepPtr is: 71
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 71, step is: 70, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 71, StepPerSlice is: 1, connStepPtr is: 68
index is: 0, now is recv, connStepCache is: 71, step is: 71, StepPerSlice is: 1, connStepPtr is: 73
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 73, step is: 71, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 72, StepPerSlice is: 1, connStepPtr is: 68
index is: 0, now is recv, connStepCache is: 73, step is: 72, StepPerSlice is: 1, connStepPtr is: 74
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 69, step is: 73, StepPerSlice is: 1, connStepPtr is: 69
index is: 0, now is recv, connStepCache is: 73, step is: 73, StepPerSlice is: 1, connStepPtr is: 75
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 75, step is: 73, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 69, step is: 74, StepPerSlice is: 1, connStepPtr is: 69
index is: 0, now is recv, connStepCache is: 75, step is: 74, StepPerSlice is: 1, connStepPtr is: 76
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 69, step is: 75, StepPerSlice is: 1, connStepPtr is: 70
index is: 0, now is recv, connStepCache is: 75, step is: 75, StepPerSlice is: 1, connStepPtr is: 77
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 77, step is: 75, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 69, step is: 76, StepPerSlice is: 1, connStepPtr is: 71
index is: 0, now is recv, connStepCache is: 77, step is: 76, StepPerSlice is: 1, connStepPtr is: 78
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 69, step is: 77, StepPerSlice is: 1, connStepPtr is: 71
index is: 0, now is recv, connStepCache is: 77, step is: 77, StepPerSlice is: 1, connStepPtr is: 79
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 79, step is: 77, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 72, step is: 78, StepPerSlice is: 1, connStepPtr is: 72
index is: 0, now is recv, connStepCache is: 79, step is: 78, StepPerSlice is: 1, connStepPtr is: 80
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 72, step is: 79, StepPerSlice is: 1, connStepPtr is: 73
index is: 0, now is recv, connStepCache is: 79, step is: 79, StepPerSlice is: 1, connStepPtr is: 80
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 80, step is: 79, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 64
In RolePostRecv, the *connStepPtr is: 64
In RoleWaitSend, the *connStepPtr is: 64
In RolePostSend, the *connStepPtr is: 64
userBuff in setDataPtrs is: 0x2b32daf00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 64, StepPerSlice is: 1, connStepPtr is: 64
index is: 0, now is recv, connStepCache is: 64, step is: 64, StepPerSlice is: 1, connStepPtr is: 64
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 65, step is: 64, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 65, StepPerSlice is: 1, connStepPtr is: 65
index is: 0, now is recv, connStepCache is: 65, step is: 65, StepPerSlice is: 1, connStepPtr is: 66
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 66, step is: 65, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 66, StepPerSlice is: 1, connStepPtr is: 66
index is: 0, now is recv, connStepCache is: 66, step is: 66, StepPerSlice is: 1, connStepPtr is: 67
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 67, step is: 66, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 67, StepPerSlice is: 1, connStepPtr is: 67
index is: 0, now is recv, connStepCache is: 67, step is: 67, StepPerSlice is: 1, connStepPtr is: 68
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 68, step is: 67, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 68, StepPerSlice is: 1, connStepPtr is: 68
index is: 0, now is recv, connStepCache is: 68, step is: 68, StepPerSlice is: 1, connStepPtr is: 70
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 70, step is: 68, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 69, StepPerSlice is: 1, connStepPtr is: 69
index is: 0, now is recv, connStepCache is: 70, step is: 69, StepPerSlice is: 1, connStepPtr is: 71
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 70, StepPerSlice is: 1, connStepPtr is: 69
index is: 0, now is recv, connStepCache is: 70, step is: 70, StepPerSlice is: 1, connStepPtr is: 72
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 72, step is: 70, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 71, StepPerSlice is: 1, connStepPtr is: 70
index is: 0, now is recv, connStepCache is: 72, step is: 71, StepPerSlice is: 1, connStepPtr is: 73
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 64, step is: 72, StepPerSlice is: 1, connStepPtr is: 71
index is: 0, now is recv, connStepCache is: 72, step is: 72, StepPerSlice is: 1, connStepPtr is: 74
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 74, step is: 72, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 73, StepPerSlice is: 1, connStepPtr is: 72
index is: 0, now is recv, connStepCache is: 74, step is: 73, StepPerSlice is: 1, connStepPtr is: 75
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 74, StepPerSlice is: 1, connStepPtr is: 73
index is: 0, now is recv, connStepCache is: 74, step is: 74, StepPerSlice is: 1, connStepPtr is: 76
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 77, step is: 74, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 75, StepPerSlice is: 1, connStepPtr is: 74
index is: 0, now is recv, connStepCache is: 77, step is: 75, StepPerSlice is: 1, connStepPtr is: 78
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 76, StepPerSlice is: 1, connStepPtr is: 75
index is: 0, now is recv, connStepCache is: 77, step is: 76, StepPerSlice is: 1, connStepPtr is: 79
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 77, StepPerSlice is: 1, connStepPtr is: 76
index is: 0, now is recv, connStepCache is: 77, step is: 77, StepPerSlice is: 1, connStepPtr is: 80
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 80, step is: 77, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 78, StepPerSlice is: 1, connStepPtr is: 76
index is: 0, now is recv, connStepCache is: 80, step is: 78, StepPerSlice is: 1, connStepPtr is: 80
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 71, step is: 79, StepPerSlice is: 1, connStepPtr is: 77
index is: 0, now is recv, connStepCache is: 80, step is: 79, StepPerSlice is: 1, connStepPtr is: 80
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 80
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 80
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 80
In RoleWaitSend, the *connStepPtr is: 80
userBuff in setDataPtrs is: 0x2b32daf00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 80, StepPerSlice is: 1, connStepPtr is: 80
index is: 0, now is recv, connStepCache is: 80, step is: 80, StepPerSlice is: 1, connStepPtr is: 80
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 81, step is: 80, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 81, StepPerSlice is: 1, connStepPtr is: 80
index is: 0, now is recv, connStepCache is: 81, step is: 81, StepPerSlice is: 1, connStepPtr is: 81
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 82, step is: 81, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 82, StepPerSlice is: 1, connStepPtr is: 81
index is: 0, now is recv, connStepCache is: 82, step is: 82, StepPerSlice is: 1, connStepPtr is: 83
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 83, step is: 82, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 83, StepPerSlice is: 1, connStepPtr is: 81
index is: 0, now is recv, connStepCache is: 83, step is: 83, StepPerSlice is: 1, connStepPtr is: 84
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 84, step is: 83, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 84, StepPerSlice is: 1, connStepPtr is: 82
index is: 0, now is recv, connStepCache is: 84, step is: 84, StepPerSlice is: 1, connStepPtr is: 85
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 85, step is: 84, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 85, StepPerSlice is: 1, connStepPtr is: 83
index is: 0, now is recv, connStepCache is: 85, step is: 85, StepPerSlice is: 1, connStepPtr is: 86
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 87, step is: 85, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 86, StepPerSlice is: 1, connStepPtr is: 83
index is: 0, now is recv, connStepCache is: 87, step is: 86, StepPerSlice is: 1, connStepPtr is: 87
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 87, StepPerSlice is: 1, connStepPtr is: 84
index is: 0, now is recv, connStepCache is: 87, step is: 87, StepPerSlice is: 1, connStepPtr is: 88
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 88, step is: 87, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 88, StepPerSlice is: 1, connStepPtr is: 84
index is: 0, now is recv, connStepCache is: 88, step is: 88, StepPerSlice is: 1, connStepPtr is: 90
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 90, step is: 88, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 85, step is: 89, StepPerSlice is: 1, connStepPtr is: 85
index is: 0, now is recv, connStepCache is: 90, step is: 89, StepPerSlice is: 1, connStepPtr is: 91
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 85, step is: 90, StepPerSlice is: 1, connStepPtr is: 86
index is: 0, now is recv, connStepCache is: 90, step is: 90, StepPerSlice is: 1, connStepPtr is: 92
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 92, step is: 90, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 85, step is: 91, StepPerSlice is: 1, connStepPtr is: 86
index is: 0, now is recv, connStepCache is: 92, step is: 91, StepPerSlice is: 1, connStepPtr is: 93
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 85, step is: 92, StepPerSlice is: 1, connStepPtr is: 87
index is: 0, now is recv, connStepCache is: 92, step is: 92, StepPerSlice is: 1, connStepPtr is: 94
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 94, step is: 92, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 85, step is: 93, StepPerSlice is: 1, connStepPtr is: 88
index is: 0, now is recv, connStepCache is: 94, step is: 93, StepPerSlice is: 1, connStepPtr is: 95
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 88, step is: 94, StepPerSlice is: 1, connStepPtr is: 88
index is: 0, now is recv, connStepCache is: 94, step is: 94, StepPerSlice is: 1, connStepPtr is: 96
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 96, step is: 94, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 88, step is: 95, StepPerSlice is: 1, connStepPtr is: 89
index is: 0, now is recv, connStepCache is: 96, step is: 95, StepPerSlice is: 1, connStepPtr is: 96
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 80
In RolePostRecv, the *connStepPtr is: 80
In RoleWaitSend, the *connStepPtr is: 80
In RolePostSend, the *connStepPtr is: 80
userBuff in setDataPtrs is: 0x2b32daf00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 80, StepPerSlice is: 1, connStepPtr is: 80
index is: 0, now is recv, connStepCache is: 80, step is: 80, StepPerSlice is: 1, connStepPtr is: 80
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 81, step is: 80, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 81, StepPerSlice is: 1, connStepPtr is: 81
index is: 0, now is recv, connStepCache is: 81, step is: 81, StepPerSlice is: 1, connStepPtr is: 82
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 82, step is: 81, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 82, StepPerSlice is: 1, connStepPtr is: 82
index is: 0, now is recv, connStepCache is: 82, step is: 82, StepPerSlice is: 1, connStepPtr is: 83
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 83, step is: 82, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 83, StepPerSlice is: 1, connStepPtr is: 83
index is: 0, now is recv, connStepCache is: 83, step is: 83, StepPerSlice is: 1, connStepPtr is: 84
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 84, step is: 83, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 84, StepPerSlice is: 1, connStepPtr is: 84
index is: 0, now is recv, connStepCache is: 84, step is: 84, StepPerSlice is: 1, connStepPtr is: 86
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 86, step is: 84, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 85, StepPerSlice is: 1, connStepPtr is: 85
index is: 0, now is recv, connStepCache is: 86, step is: 85, StepPerSlice is: 1, connStepPtr is: 87
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 86, StepPerSlice is: 1, connStepPtr is: 85
index is: 0, now is recv, connStepCache is: 86, step is: 86, StepPerSlice is: 1, connStepPtr is: 88
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 88, step is: 86, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 87, StepPerSlice is: 1, connStepPtr is: 86
index is: 0, now is recv, connStepCache is: 88, step is: 87, StepPerSlice is: 1, connStepPtr is: 89
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 80, step is: 88, StepPerSlice is: 1, connStepPtr is: 87
index is: 0, now is recv, connStepCache is: 88, step is: 88, StepPerSlice is: 1, connStepPtr is: 90
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 90, step is: 88, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 89, StepPerSlice is: 1, connStepPtr is: 88
index is: 0, now is recv, connStepCache is: 90, step is: 89, StepPerSlice is: 1, connStepPtr is: 91
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 90, StepPerSlice is: 1, connStepPtr is: 89
index is: 0, now is recv, connStepCache is: 90, step is: 90, StepPerSlice is: 1, connStepPtr is: 92
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 92, step is: 90, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 91, StepPerSlice is: 1, connStepPtr is: 90
index is: 0, now is recv, connStepCache is: 92, step is: 91, StepPerSlice is: 1, connStepPtr is: 94
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 92, StepPerSlice is: 1, connStepPtr is: 91
index is: 0, now is recv, connStepCache is: 92, step is: 92, StepPerSlice is: 1, connStepPtr is: 95
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 95, step is: 92, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 93, StepPerSlice is: 1, connStepPtr is: 92
index is: 0, now is recv, connStepCache is: 95, step is: 93, StepPerSlice is: 1, connStepPtr is: 96
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 94, StepPerSlice is: 1, connStepPtr is: 92
index is: 0, now is recv, connStepCache is: 95, step is: 94, StepPerSlice is: 1, connStepPtr is: 96
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 87, step is: 95, StepPerSlice is: 1, connStepPtr is: 93
index is: 0, now is recv, connStepCache is: 95, step is: 95, StepPerSlice is: 1, connStepPtr is: 96
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 96, step is: 95, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 96
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 96
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 96
In RoleWaitSend, the *connStepPtr is: 96
userBuff in setDataPtrs is: 0x2b32daf00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 96, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 96, step is: 96, StepPerSlice is: 1, connStepPtr is: 96
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 97, step is: 96, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 97, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 97, step is: 97, StepPerSlice is: 1, connStepPtr is: 97
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 98, step is: 97, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 98, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 98, step is: 98, StepPerSlice is: 1, connStepPtr is: 99
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 99, step is: 98, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 99, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 99, step is: 99, StepPerSlice is: 1, connStepPtr is: 100
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 100, step is: 99, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 100, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 100, step is: 100, StepPerSlice is: 1, connStepPtr is: 101
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 101, step is: 100, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 101, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 101, step is: 101, StepPerSlice is: 1, connStepPtr is: 102
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 102, step is: 101, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 102, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 102, step is: 102, StepPerSlice is: 1, connStepPtr is: 103
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 103, step is: 102, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 103, StepPerSlice is: 1, connStepPtr is: 97
index is: 0, now is recv, connStepCache is: 103, step is: 103, StepPerSlice is: 1, connStepPtr is: 105
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 105, step is: 103, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 104, StepPerSlice is: 1, connStepPtr is: 97
index is: 0, now is recv, connStepCache is: 105, step is: 104, StepPerSlice is: 1, connStepPtr is: 106
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 97, step is: 105, StepPerSlice is: 1, connStepPtr is: 98
index is: 0, now is recv, connStepCache is: 105, step is: 105, StepPerSlice is: 1, connStepPtr is: 107
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 107, step is: 105, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 98, step is: 106, StepPerSlice is: 1, connStepPtr is: 98
index is: 0, now is recv, connStepCache is: 107, step is: 106, StepPerSlice is: 1, connStepPtr is: 108
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 99, step is: 107, StepPerSlice is: 1, connStepPtr is: 99
index is: 0, now is recv, connStepCache is: 107, step is: 107, StepPerSlice is: 1, connStepPtr is: 109
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 109, step is: 107, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 100, step is: 108, StepPerSlice is: 1, connStepPtr is: 100
index is: 0, now is recv, connStepCache is: 109, step is: 108, StepPerSlice is: 1, connStepPtr is: 110
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 101, step is: 109, StepPerSlice is: 1, connStepPtr is: 101
index is: 0, now is recv, connStepCache is: 109, step is: 109, StepPerSlice is: 1, connStepPtr is: 112
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 112, step is: 109, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 102, step is: 110, StepPerSlice is: 1, connStepPtr is: 102
index is: 0, now is recv, connStepCache is: 112, step is: 110, StepPerSlice is: 1, connStepPtr is: 112
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 111, StepPerSlice is: 1, connStepPtr is: 103
index is: 0, now is recv, connStepCache is: 112, step is: 111, StepPerSlice is: 1, connStepPtr is: 112
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 96
In RolePostRecv, the *connStepPtr is: 96
In RoleWaitSend, the *connStepPtr is: 96
In RolePostSend, the *connStepPtr is: 96
userBuff in setDataPtrs is: 0x2b32daf00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 96, StepPerSlice is: 1, connStepPtr is: 96
index is: 0, now is recv, connStepCache is: 96, step is: 96, StepPerSlice is: 1, connStepPtr is: 96
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 97, step is: 96, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 97, StepPerSlice is: 1, connStepPtr is: 97
index is: 0, now is recv, connStepCache is: 97, step is: 97, StepPerSlice is: 1, connStepPtr is: 98
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 98, step is: 97, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 98, StepPerSlice is: 1, connStepPtr is: 98
index is: 0, now is recv, connStepCache is: 98, step is: 98, StepPerSlice is: 1, connStepPtr is: 99
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 99, step is: 98, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 99, StepPerSlice is: 1, connStepPtr is: 99
index is: 0, now is recv, connStepCache is: 99, step is: 99, StepPerSlice is: 1, connStepPtr is: 100
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 100, step is: 99, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 100, StepPerSlice is: 1, connStepPtr is: 100
index is: 0, now is recv, connStepCache is: 100, step is: 100, StepPerSlice is: 1, connStepPtr is: 102
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 102, step is: 100, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 101, StepPerSlice is: 1, connStepPtr is: 101
index is: 0, now is recv, connStepCache is: 102, step is: 101, StepPerSlice is: 1, connStepPtr is: 103
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 102, StepPerSlice is: 1, connStepPtr is: 101
index is: 0, now is recv, connStepCache is: 102, step is: 102, StepPerSlice is: 1, connStepPtr is: 104
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 104, step is: 102, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 103, StepPerSlice is: 1, connStepPtr is: 102
index is: 0, now is recv, connStepCache is: 104, step is: 103, StepPerSlice is: 1, connStepPtr is: 105
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 96, step is: 104, StepPerSlice is: 1, connStepPtr is: 103
index is: 0, now is recv, connStepCache is: 104, step is: 104, StepPerSlice is: 1, connStepPtr is: 106
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 106, step is: 104, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 105, StepPerSlice is: 1, connStepPtr is: 104
index is: 0, now is recv, connStepCache is: 106, step is: 105, StepPerSlice is: 1, connStepPtr is: 108
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 106, StepPerSlice is: 1, connStepPtr is: 105
index is: 0, now is recv, connStepCache is: 106, step is: 106, StepPerSlice is: 1, connStepPtr is: 108
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 109, step is: 106, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 107, StepPerSlice is: 1, connStepPtr is: 106
index is: 0, now is recv, connStepCache is: 109, step is: 107, StepPerSlice is: 1, connStepPtr is: 110
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 108, StepPerSlice is: 1, connStepPtr is: 107
index is: 0, now is recv, connStepCache is: 109, step is: 108, StepPerSlice is: 1, connStepPtr is: 111
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 109, StepPerSlice is: 1, connStepPtr is: 107
index is: 0, now is recv, connStepCache is: 109, step is: 109, StepPerSlice is: 1, connStepPtr is: 112
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 112, step is: 109, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 110, StepPerSlice is: 1, connStepPtr is: 109
index is: 0, now is recv, connStepCache is: 112, step is: 110, StepPerSlice is: 1, connStepPtr is: 112
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 103, step is: 111, StepPerSlice is: 1, connStepPtr is: 109
index is: 0, now is recv, connStepCache is: 112, step is: 111, StepPerSlice is: 1, connStepPtr is: 112
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
before cudaLaunchKernel() 
cudaLaunchKernel() finished
before run() in ncclkernel()
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
runTreeUpDown launched
In RolePostRecv, the *connStepPtr is: 112
NCCL_MAX_DEV_ARITY is: 2
tee->[2] is: -1
In RolePostSend, the *connStepPtr is: 112
peer in flags & (RoleWaitSend|RolePostSend) is: 0, index is:0
In RoleWaitRecv, the *connStepPtr is: 112
In RoleWaitSend, the *connStepPtr is: 112
userBuff in setDataPtrs is: 0x2b32daf00000
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 112, StepPerSlice is: 1, connStepPtr is: 112
index is: 0, now is recv, connStepCache is: 112, step is: 112, StepPerSlice is: 1, connStepPtr is: 112
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 113, step is: 112, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 0, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 113, StepPerSlice is: 1, connStepPtr is: 112
index is: 0, now is recv, connStepCache is: 113, step is: 113, StepPerSlice is: 1, connStepPtr is: 114
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 114, step is: 113, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 16384, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 114, StepPerSlice is: 1, connStepPtr is: 112
index is: 0, now is recv, connStepCache is: 114, step is: 114, StepPerSlice is: 1, connStepPtr is: 115
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 115, step is: 114, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 32768, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 115, StepPerSlice is: 1, connStepPtr is: 113
index is: 0, now is recv, connStepCache is: 115, step is: 115, StepPerSlice is: 1, connStepPtr is: 116
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 116, step is: 115, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 49152, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 116, StepPerSlice is: 1, connStepPtr is: 114
index is: 0, now is recv, connStepCache is: 116, step is: 116, StepPerSlice is: 1, connStepPtr is: 117
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 117, step is: 116, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 65536, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 117, StepPerSlice is: 1, connStepPtr is: 115
index is: 0, now is recv, connStepCache is: 117, step is: 117, StepPerSlice is: 1, connStepPtr is: 119
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 119, step is: 117, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 81920, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 118, StepPerSlice is: 1, connStepPtr is: 115
index is: 0, now is recv, connStepCache is: 119, step is: 118, StepPerSlice is: 1, connStepPtr is: 120
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 98304, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 119, StepPerSlice is: 1, connStepPtr is: 116
index is: 0, now is recv, connStepCache is: 119, step is: 119, StepPerSlice is: 1, connStepPtr is: 121
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 121, step is: 119, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 114688, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 120, StepPerSlice is: 1, connStepPtr is: 117
index is: 0, now is recv, connStepCache is: 121, step is: 120, StepPerSlice is: 1, connStepPtr is: 122
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 131072, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 117, step is: 121, StepPerSlice is: 1, connStepPtr is: 117
index is: 0, now is recv, connStepCache is: 121, step is: 121, StepPerSlice is: 1, connStepPtr is: 123
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 123, step is: 121, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 147456, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 117, step is: 122, StepPerSlice is: 1, connStepPtr is: 118
index is: 0, now is recv, connStepCache is: 123, step is: 122, StepPerSlice is: 1, connStepPtr is: 124
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 163840, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 117, step is: 123, StepPerSlice is: 1, connStepPtr is: 119
index is: 0, now is recv, connStepCache is: 123, step is: 123, StepPerSlice is: 1, connStepPtr is: 125
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 125, step is: 123, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 180224, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 117, step is: 124, StepPerSlice is: 1, connStepPtr is: 120
index is: 0, now is recv, connStepCache is: 125, step is: 124, StepPerSlice is: 1, connStepPtr is: 127
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 196608, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 117, step is: 125, StepPerSlice is: 1, connStepPtr is: 120
index is: 0, now is recv, connStepCache is: 125, step is: 125, StepPerSlice is: 1, connStepPtr is: 127
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 127, step is: 125, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 212992, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 120, step is: 126, StepPerSlice is: 1, connStepPtr is: 121
index is: 0, now is recv, connStepCache is: 127, step is: 126, StepPerSlice is: 1, connStepPtr is: 128
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 229376, size is 262144
Reduce/down[1] == -1/ /pre: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 120, step is: 127, StepPerSlice is: 1, connStepPtr is: 121
index is: 0, now is recv, connStepCache is: 127, step is: 127, StepPerSlice is: 1, connStepPtr is: 128
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 128, step is: 127, StepPerSlice is: 1
Reduce/down[1] == -1/ /post: prims3.recvReduceSend, bid=0, gridOffset is: 245760, size is 262144
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
peer in flags & (RoleWaitSend|RolePostSend) is: 2, index is:0
In RoleWaitRecv, the *connStepPtr is: 112
In RolePostRecv, the *connStepPtr is: 112
In RoleWaitSend, the *connStepPtr is: 112
In RolePostSend, the *connStepPtr is: 112
userBuff in setDataPtrs is: 0x2b32daf00000
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 112, StepPerSlice is: 1, connStepPtr is: 112
index is: 0, now is recv, connStepCache is: 112, step is: 112, StepPerSlice is: 1, connStepPtr is: 112
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 113, step is: 112, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 0, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 113, StepPerSlice is: 1, connStepPtr is: 113
index is: 0, now is recv, connStepCache is: 113, step is: 113, StepPerSlice is: 1, connStepPtr is: 114
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 114, step is: 113, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 16384, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 114, StepPerSlice is: 1, connStepPtr is: 114
index is: 0, now is recv, connStepCache is: 114, step is: 114, StepPerSlice is: 1, connStepPtr is: 115
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 115, step is: 114, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 32768, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 115, StepPerSlice is: 1, connStepPtr is: 115
index is: 0, now is recv, connStepCache is: 115, step is: 115, StepPerSlice is: 1, connStepPtr is: 116
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 116, step is: 115, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 49152, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 116, StepPerSlice is: 1, connStepPtr is: 116
index is: 0, now is recv, connStepCache is: 116, step is: 116, StepPerSlice is: 1, connStepPtr is: 118
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 118, step is: 116, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 65536, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 117, StepPerSlice is: 1, connStepPtr is: 117
index is: 0, now is recv, connStepCache is: 118, step is: 117, StepPerSlice is: 1, connStepPtr is: 119
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 81920, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 118, StepPerSlice is: 1, connStepPtr is: 117
index is: 0, now is recv, connStepCache is: 118, step is: 118, StepPerSlice is: 1, connStepPtr is: 120
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 120, step is: 118, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 98304, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 119, StepPerSlice is: 1, connStepPtr is: 118
index is: 0, now is recv, connStepCache is: 120, step is: 119, StepPerSlice is: 1, connStepPtr is: 121
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 114688, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
index is: 0, now is send, connStepCache is: 112, step is: 120, StepPerSlice is: 1, connStepPtr is: 119
index is: 0, now is recv, connStepCache is: 120, step is: 120, StepPerSlice is: 1, connStepPtr is: 122
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 122, step is: 120, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 131072, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 121, StepPerSlice is: 1, connStepPtr is: 120
index is: 0, now is recv, connStepCache is: 122, step is: 121, StepPerSlice is: 1, connStepPtr is: 123
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 147456, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 122, StepPerSlice is: 1, connStepPtr is: 121
index is: 0, now is recv, connStepCache is: 122, step is: 122, StepPerSlice is: 1, connStepPtr is: 124
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 124, step is: 122, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 163840, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 123, StepPerSlice is: 1, connStepPtr is: 122
index is: 0, now is recv, connStepCache is: 124, step is: 123, StepPerSlice is: 1, connStepPtr is: 126
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 180224, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 124, StepPerSlice is: 1, connStepPtr is: 123
index is: 0, now is recv, connStepCache is: 124, step is: 124, StepPerSlice is: 1, connStepPtr is: 127
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 127, step is: 124, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 196608, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 125, StepPerSlice is: 1, connStepPtr is: 124
index is: 0, now is recv, connStepCache is: 127, step is: 125, StepPerSlice is: 1, connStepPtr is: 128
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 212992, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 126, StepPerSlice is: 1, connStepPtr is: 124
index is: 0, now is recv, connStepCache is: 127, step is: 126, StepPerSlice is: 1, connStepPtr is: 128
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 229376, size is 262144
Broadcast/down[1] == -1/pre: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
index is: 0, now is send, connStepCache is: 119, step is: 127, StepPerSlice is: 1, connStepPtr is: 125
index is: 0, now is recv, connStepCache is: 127, step is: 127, StepPerSlice is: 1, connStepPtr is: 128
Ready to exit while loop-- now is recv, index is: 0, connStepCache is: 128, step is: 127, StepPerSlice is: 1
Broadcast/down[1] == -1/post: prims3.directRecvCopySend, bid=0, gridOffset is: 245760, size is 262144
runTreeUpDown() finished
after run() in ncclkernel(), before __syncthreads()
after run() in ncclkernel(), after __syncthreads()
in the end of ncclkernel()
after BenchTime()
TimeTest finished
ncclTestEngine() finished
c199-031:30852:30852 [1] NCCL INFO comm 0x8d52a80 rank 1 nranks 16 cudaDev 1 busId 3000 - Destroy COMPLETE
