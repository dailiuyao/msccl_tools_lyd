# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 20 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  27186 on x3210c0s7b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  22376 on x3210c0s7b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3210c0s7b0n0:27186:27186 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.86<0>
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3210c0s7b0n0:27186:27186 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3210c0s7b0n0:27186:27186 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3210c0s7b0n0:27186:27202 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 4.
x3210c0s7b0n0:27186:27202 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 4.
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 00/04 :    0   1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 01/04 :    0   1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 02/04 :    0   1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 03/04 :    0   1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->-1 [3] -1/-1/-1->0->1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 02/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 03/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 02/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Channel 03/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Connected all rings
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Connected all trees
x3210c0s7b0n0:27186:27202 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel4_chunk8.xml
x3210c0s7b0n0:27186:27202 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel4_chunk8.xml
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel4_chunk8.xml successfully.
x3210c0s7b0n0:27186:27202 [0] NCCL INFO Connected 1 MSCCL algorithms
x3210c0s7b0n0:27186:27202 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3210c0s7b0n0:27186:27202 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3210c0s7b0n0:27186:27202 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3210c0s7b0n0:27186:27202 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3210c0s7b0n0:27186:27202 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3210c0s7b0n0:27186:27202 [0] NCCL INFO comm 0x154bc645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3210c0s7b0n0:27186:27186 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    60.57    0.02    0.02    512    60.14    0.02    0.02      0
        2048           512     float     sum      -1    59.68    0.03    0.03   1024    59.71    0.03    0.03      0
        4096          1024     float     sum      -1    59.48    0.07    0.07   2048    59.80    0.07    0.07      0
        8192          2048     float     sum      -1    59.57    0.14    0.14   4096    59.73    0.14    0.14      0
       16384          4096     float     sum      -1    60.54    0.27    0.27   8192    60.48    0.27    0.27      0
       32768          8192     float     sum      -1    63.19    0.52    0.52  16384    63.15    0.52    0.52      0
       65536         16384     float     sum      -1    65.02    1.01    1.01  32768    64.95    1.01    1.01      0
      131072         32768     float     sum      -1    68.47    1.91    1.91  65536    68.52    1.91    1.91      0
      262144         65536     float     sum      -1    88.61    2.96    2.96  131072    88.32    2.97    2.97      0
      524288        131072     float     sum      -1    110.6    4.74    4.74  262144    109.8    4.78    4.78      0
     1048576        262144     float     sum      -1    166.5    6.30    6.30  524288    166.3    6.30    6.30      0
     2097152        524288     float     sum      -1    286.6    7.32    7.32  1.04858e+06    286.8    7.31    7.31      0
     4194304       1048576     float     sum      -1    527.4    7.95    7.95  2.09715e+06    528.0    7.94    7.94      0
     8388608       2097152     float     sum      -1    976.9    8.59    8.59  4.1943e+06    978.7    8.57    8.57      0
    16777216       4194304     float     sum      -1   1943.9    8.63    8.63  8.38861e+06   1918.7    8.74    8.74      0
    33554432       8388608     float     sum      -1   3622.7    9.26    9.26  1.67772e+07   3624.0    9.26    9.26      0
    67108864      16777216     float     sum      -1   7057.9    9.51    9.51  3.35544e+07   7075.6    9.48    9.48      0
   134217728      33554432     float     sum      -1    13971    9.61    9.61  6.71088e+07    13961    9.61    9.61      0
   268435456      67108864     float     sum      -1    27782    9.66    9.66  1.34218e+08    27627    9.72    9.72      0
   536870912     134217728     float     sum      -1    54409    9.87    9.87  2.68435e+08    54336    9.88    9.88      0
x3210c0s7b0n0:27186:27186 [0] NCCL INFO comm 0x154bc645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 4.92251 
#

