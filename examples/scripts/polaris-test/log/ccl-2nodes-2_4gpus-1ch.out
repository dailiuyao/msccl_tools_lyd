NCCL TEST with NCCL_MSCCL 1 channel 2gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30053 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   1036 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30053:30053 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30053:30053 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30053:30053 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1036:1036 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1036:1036 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1036:1036 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30053:30065 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30053:30065 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Channel 00/01 :    0   1
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3209c0s13b1n0:1036:1049 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1036:1049 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1036:1049 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b1n0:1036:1049 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1036:1049 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1036:1049 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1036:1049 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1036:1049 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:1036:1049 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1036:1049 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1036:1049 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1036:1049 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30053:30065 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30053:30065 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:30053:30065 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30053:30065 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30053:30065 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30053:30065 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1036:1049 [0] NCCL INFO comm 0x1536996b1010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:30053:30065 [0] NCCL INFO comm 0x1506da45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30053:30053 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    36.92    0.03    0.03      0    38.93    0.03    0.03      0
        2048           512     float     sum      -1    38.17    0.05    0.05      0    38.14    0.05    0.05      0
        4096          1024     float     sum      -1    37.52    0.11    0.11      0    37.40    0.11    0.11      0
        8192          2048     float     sum      -1    39.56    0.21    0.21      0    39.12    0.21    0.21      0
       16384          4096     float     sum      -1    42.31    0.39    0.39      0    42.05    0.39    0.39      0
       32768          8192     float     sum      -1    54.20    0.60    0.60      0    53.86    0.61    0.61      0
       65536         16384     float     sum      -1    68.15    0.96    0.96      0    67.19    0.98    0.98      0
      131072         32768     float     sum      -1    92.62    1.42    1.42      0    91.74    1.43    1.43      0
      262144         65536     float     sum      -1    135.7    1.93    1.93      0    134.6    1.95    1.95      0
      524288        131072     float     sum      -1    195.9    2.68    2.68      0    196.3    2.67    2.67      0
     1048576        262144     float     sum      -1    331.9    3.16    3.16      0    329.5    3.18    3.18      0
     2097152        524288     float     sum      -1    549.7    3.81    3.81      0    547.7    3.83    3.83      0
     4194304       1048576     float     sum      -1   1019.3    4.12    4.12      0   1017.1    4.12    4.12      0
     8388608       2097152     float     sum      -1   1900.8    4.41    4.41      0   1909.2    4.39    4.39      0
    16777216       4194304     float     sum      -1   3711.8    4.52    4.52      0   3676.5    4.56    4.56      0
    33554432       8388608     float     sum      -1   7220.9    4.65    4.65      0   7223.0    4.65    4.65      0
    67108864      16777216     float     sum      -1    14300    4.69    4.69      0    14255    4.71    4.71      0
   134217728      33554432     float     sum      -1    28384    4.73    4.73      0    28461    4.72    4.72      0
   268435456      67108864     float     sum      -1    56846    4.72    4.72      0    56575    4.74    4.74      0
   536870912     134217728     float     sum      -1   113042    4.75    4.75      0   113528    4.73    4.73      0
x3209c0s13b0n0:30053:30053 [0] NCCL INFO comm 0x1506da45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1036:1036 [0] NCCL INFO comm 0x1536996b1010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 2.59979 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30161 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   1146 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30161:30161 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30161:30161 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30161:30161 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1146:1146 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1146:1146 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1146:1146 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30161:30228 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30161:30228 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Channel 00/01 :    0   1
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3209c0s13b1n0:1146:1232 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1146:1232 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1146:1232 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1146:1232 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1146:1232 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1146:1232 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1146:1232 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1146:1232 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:1146:1232 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1146:1232 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1146:1232 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1146:1232 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30161:30228 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30161:30228 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:30161:30228 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30161:30228 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30161:30228 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30161:30228 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1146:1232 [0] NCCL INFO comm 0x1497f645a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:30161:30228 [0] NCCL INFO comm 0x15075c45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30161:30161 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    37.17    0.03    0.03      0    36.43    0.03    0.03      0
        2048           512     float     sum      -1    38.23    0.05    0.05      0    37.63    0.05    0.05      0
        4096          1024     float     sum      -1    37.38    0.11    0.11      0    37.30    0.11    0.11      0
        8192          2048     float     sum      -1    36.56    0.22    0.22      0    36.22    0.23    0.23      0
       16384          4096     float     sum      -1    39.19    0.42    0.42      0    38.73    0.42    0.42      0
       32768          8192     float     sum      -1    51.64    0.63    0.63      0    51.65    0.63    0.63      0
       65536         16384     float     sum      -1    61.08    1.07    1.07      0    60.73    1.08    1.08      0
      131072         32768     float     sum      -1    80.50    1.63    1.63      0    79.87    1.64    1.64      0
      262144         65536     float     sum      -1    112.3    2.33    2.33      0    111.1    2.36    2.36      0
      524288        131072     float     sum      -1    157.3    3.33    3.33      0    156.7    3.35    3.35      0
     1048576        262144     float     sum      -1    255.9    4.10    4.10      0    253.9    4.13    4.13      0
     2097152        524288     float     sum      -1    411.4    5.10    5.10      0    410.6    5.11    5.11      0
     4194304       1048576     float     sum      -1    723.8    5.79    5.79      0    722.4    5.81    5.81      0
     8388608       2097152     float     sum      -1   1302.3    6.44    6.44      0   1304.9    6.43    6.43      0
    16777216       4194304     float     sum      -1   2472.1    6.79    6.79      0   2476.0    6.78    6.78      0
    33554432       8388608     float     sum      -1   4729.5    7.09    7.09      0   4735.8    7.09    7.09      0
    67108864      16777216     float     sum      -1   9299.9    7.22    7.22      0   9291.6    7.22    7.22      0
   134217728      33554432     float     sum      -1    18438    7.28    7.28      0    18440    7.28    7.28      0
   268435456      67108864     float     sum      -1    36653    7.32    7.32      0    36707    7.31    7.31      0
   536870912     134217728     float     sum      -1    73233    7.33    7.33      0    73194    7.33    7.33      0
x3209c0s13b0n0:30161:30161 [0] NCCL INFO comm 0x15075c45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1146:1146 [0] NCCL INFO comm 0x1497f645a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 3.71707 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30254 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   1239 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30254:30254 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30254:30254 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30254:30254 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1239:1239 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1239:1239 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1239:1239 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30254:30270 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30254:30270 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Channel 00/01 :    0   1
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3209c0s13b1n0:1239:1253 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1239:1253 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1239:1253 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1239:1253 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1239:1253 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30254:30270 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30254:30270 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:30254:30270 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30254:30270 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30254:30270 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30254:30270 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1239:1253 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1239:1253 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1239:1253 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:1239:1253 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1239:1253 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1239:1253 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1239:1253 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1239:1253 [0] NCCL INFO comm 0x14e79581a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:30254:30270 [0] NCCL INFO comm 0x1536aa45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30254:30254 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    36.96    0.03    0.03      0    37.01    0.03    0.03      0
        2048           512     float     sum      -1    38.05    0.05    0.05      0    38.17    0.05    0.05      0
        4096          1024     float     sum      -1    37.35    0.11    0.11      0    37.24    0.11    0.11      0
        8192          2048     float     sum      -1    36.52    0.22    0.22      0    36.41    0.22    0.22      0
       16384          4096     float     sum      -1    40.39    0.41    0.41      0    40.42    0.41    0.41      0
       32768          8192     float     sum      -1    50.42    0.65    0.65      0    50.20    0.65    0.65      0
       65536         16384     float     sum      -1    60.77    1.08    1.08      0    60.36    1.09    1.09      0
      131072         32768     float     sum      -1    77.88    1.68    1.68      0    77.43    1.69    1.69      0
      262144         65536     float     sum      -1    106.2    2.47    2.47      0    105.4    2.49    2.49      0
      524288        131072     float     sum      -1    141.2    3.71    3.71      0    141.3    3.71    3.71      0
     1048576        262144     float     sum      -1    221.7    4.73    4.73      0    221.6    4.73    4.73      0
     2097152        524288     float     sum      -1    357.9    5.86    5.86      0    357.7    5.86    5.86      0
     4194304       1048576     float     sum      -1    625.4    6.71    6.71      0    625.3    6.71    6.71      0
     8388608       2097152     float     sum      -1   1115.2    7.52    7.52      0   1115.1    7.52    7.52      0
    16777216       4194304     float     sum      -1   2051.6    8.18    8.18      0   2077.0    8.08    8.08      0
    33554432       8388608     float     sum      -1   3931.1    8.54    8.54      0   3904.5    8.59    8.59      0
    67108864      16777216     float     sum      -1   7571.4    8.86    8.86      0   7570.5    8.86    8.86      0
   134217728      33554432     float     sum      -1    14899    9.01    9.01      0    14910    9.00    9.00      0
   268435456      67108864     float     sum      -1    29555    9.08    9.08      0    29558    9.08    9.08      0
   536870912     134217728     float     sum      -1    58858    9.12    9.12      0    58877    9.12    9.12      0
x3209c0s13b0n0:30254:30254 [0] NCCL INFO comm 0x1536aa45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1239:1239 [0] NCCL INFO comm 0x14e79581a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 4.40093 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30347 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   1326 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30347:30347 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30347:30347 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30347:30347 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1326:1326 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1326:1326 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1326:1326 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30347:30365 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30347:30365 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Channel 00/01 :    0   1
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3209c0s13b1n0:1326:1343 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1326:1343 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1326:1343 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b1n0:1326:1343 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1326:1343 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30347:30365 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30347:30365 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:30347:30365 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30347:30365 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30347:30365 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30347:30365 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1326:1343 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1326:1343 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1326:1343 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:1326:1343 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1326:1343 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1326:1343 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1326:1343 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30347:30365 [0] NCCL INFO comm 0x1513dc45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30347:30347 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:1326:1343 [0] NCCL INFO comm 0x15030845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    36.99    0.03    0.03      0    36.77    0.03    0.03      0
        2048           512     float     sum      -1    38.08    0.05    0.05      0    37.77    0.05    0.05      0
        4096          1024     float     sum      -1    37.58    0.11    0.11      0    37.25    0.11    0.11      0
        8192          2048     float     sum      -1    36.66    0.22    0.22      0    36.38    0.23    0.23      0
       16384          4096     float     sum      -1    42.28    0.39    0.39      0    40.23    0.41    0.41      0
       32768          8192     float     sum      -1    53.72    0.61    0.61      0    53.57    0.61    0.61      0
       65536         16384     float     sum      -1    62.28    1.05    1.05      0    62.14    1.05    1.05      0
      131072         32768     float     sum      -1    79.25    1.65    1.65      0    78.72    1.67    1.67      0
      262144         65536     float     sum      -1    105.0    2.50    2.50      0    105.0    2.50    2.50      0
      524288        131072     float     sum      -1    147.0    3.57    3.57      0    146.9    3.57    3.57      0
     1048576        262144     float     sum      -1    232.5    4.51    4.51      0    232.0    4.52    4.52      0
     2097152        524288     float     sum      -1    380.3    5.51    5.51      0    380.2    5.52    5.52      0
     4194304       1048576     float     sum      -1    662.5    6.33    6.33      0    665.1    6.31    6.31      0
     8388608       2097152     float     sum      -1   1189.1    7.05    7.05      0   1190.4    7.05    7.05      0
    16777216       4194304     float     sum      -1   2236.2    7.50    7.50      0   2204.6    7.61    7.61      0
    33554432       8388608     float     sum      -1   4215.5    7.96    7.96      0   4220.7    7.95    7.95      0
    67108864      16777216     float     sum      -1   8224.8    8.16    8.16      0   8226.2    8.16    8.16      0
   134217728      33554432     float     sum      -1    16231    8.27    8.27      0    16233    8.27    8.27      0
   268435456      67108864     float     sum      -1    32234    8.33    8.33      0    32239    8.33    8.33      0
   536870912     134217728     float     sum      -1    64198    8.36    8.36      0    64202    8.36    8.36      0
x3209c0s13b0n0:30347:30347 [0] NCCL INFO comm 0x1513dc45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1326:1326 [0] NCCL INFO comm 0x15030845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 4.11145 
#

NCCL TEST with NCCL_MSCCL 1 channel 4gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30373 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  30374 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   1348 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   1349 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30373:30373 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30373:30373 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30373:30373 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30374:30374 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30374:30374 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30374:30374 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1349:1349 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1348:1348 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1349:1349 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1348:1348 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1349:1349 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1348:1348 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30373:30393 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30373:30393 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3209c0s13b0n0:30374:30394 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30374:30394 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30374:30394 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b1n0:1348:1369 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1348:1369 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3209c0s13b1n0:1349:1368 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1349:1368 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1349:1368 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b0n0:30374:30394 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:1349:1368 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:30374:30394 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:30374:30394 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1349:1368 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:1349:1368 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1348:1369 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1348:1369 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:1348:1369 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1348:1369 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1348:1369 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1348:1369 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1349:1368 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:1349:1368 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:1349:1368 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1349:1368 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1349:1368 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1349:1368 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30373:30393 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30373:30393 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:30373:30393 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30373:30393 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30373:30393 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30373:30393 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30374:30394 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:30374:30394 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:30374:30394 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30374:30394 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30374:30394 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30374:30394 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1348:1369 [0] NCCL INFO comm 0x14659c703010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b1n0:1349:1368 [1] NCCL INFO comm 0x153a1c01f010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30373:30393 [0] NCCL INFO comm 0x15297045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30374:30394 [1] NCCL INFO comm 0x151ecc45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30373:30373 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    45.10    0.02    0.03      0    44.92    0.02    0.03      0
        2048           512     float     sum      -1    46.24    0.04    0.07      0    46.89    0.04    0.07      0
        4096          1024     float     sum      -1    48.81    0.08    0.13      0    48.60    0.08    0.13      0
        8192          2048     float     sum      -1    51.04    0.16    0.24      0    50.72    0.16    0.24      0
       16384          4096     float     sum      -1    54.91    0.30    0.45      0    54.36    0.30    0.45      0
       32768          8192     float     sum      -1    71.93    0.46    0.68      0    71.43    0.46    0.69      0
       65536         16384     float     sum      -1    94.37    0.69    1.04      0    93.74    0.70    1.05      0
      131072         32768     float     sum      -1    132.3    0.99    1.49      0    130.4    1.01    1.51      0
      262144         65536     float     sum      -1    197.2    1.33    1.99      0    196.5    1.33    2.00      0
      524288        131072     float     sum      -1    326.4    1.61    2.41      0    327.1    1.60    2.40      0
     1048576        262144     float     sum      -1    513.1    2.04    3.07      0    513.9    2.04    3.06      0
     2097152        524288     float     sum      -1    937.3    2.24    3.36      0    935.2    2.24    3.36      0
     4194304       1048576     float     sum      -1   1634.1    2.57    3.85      0   1654.4    2.54    3.80      0
     8388608       2097152     float     sum      -1   3119.7    2.69    4.03      0   3111.5    2.70    4.04      0
    16777216       4194304     float     sum      -1   6034.2    2.78    4.17      0   6051.5    2.77    4.16      0
    33554432       8388608     float     sum      -1    11852    2.83    4.25      0    11849    2.83    4.25      0
    67108864      16777216     float     sum      -1    23520    2.85    4.28      0    23491    2.86    4.29      0
   134217728      33554432     float     sum      -1    46851    2.86    4.30      0    46786    2.87    4.30      0
   268435456      67108864     float     sum      -1    93527    2.87    4.31      0    93360    2.88    4.31      0
   536870912     134217728     float     sum      -1   186862    2.87    4.31      0   186537    2.88    4.32      0
x3209c0s13b0n0:30374:30374 [1] NCCL INFO comm 0x151ecc45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:1349:1349 [1] NCCL INFO comm 0x153a1c01f010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:30373:30373 [0] NCCL INFO comm 0x15297045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1348:1348 [0] NCCL INFO comm 0x14659c703010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 2.42274 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30569 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  30570 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   1541 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   1542 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30569:30569 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30569:30569 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30569:30569 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30570:30570 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30570:30570 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30570:30570 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1542:1542 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1541:1541 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1542:1542 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1541:1541 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1542:1542 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1541:1541 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30570:30589 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30570:30589 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30570:30589 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b0n0:30569:30588 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30569:30588 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3209c0s13b1n0:1541:1560 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1541:1560 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3209c0s13b1n0:1542:1559 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1542:1559 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1542:1559 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:1542:1559 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:30570:30589 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:30570:30589 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:30570:30589 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:1542:1559 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:1542:1559 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1541:1560 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1541:1560 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:1541:1560 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1541:1560 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1541:1560 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1541:1560 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1542:1559 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:1542:1559 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:1542:1559 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1542:1559 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1542:1559 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1542:1559 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30569:30588 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30569:30588 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:30569:30588 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30569:30588 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30569:30588 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30569:30588 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30570:30589 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:30570:30589 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:30570:30589 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30570:30589 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30570:30589 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30570:30589 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1541:1560 [0] NCCL INFO comm 0x14a1da45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b1n0:1542:1559 [1] NCCL INFO comm 0x150f2045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30569:30588 [0] NCCL INFO comm 0x1544c045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30570:30589 [1] NCCL INFO comm 0x14e60601f010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30569:30569 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    45.11    0.02    0.03      0    44.83    0.02    0.03      0
        2048           512     float     sum      -1    46.72    0.04    0.07      0    46.39    0.04    0.07      0
        4096          1024     float     sum      -1    48.80    0.08    0.13      0    48.46    0.08    0.13      0
        8192          2048     float     sum      -1    47.43    0.17    0.26      0    47.18    0.17    0.26      0
       16384          4096     float     sum      -1    51.44    0.32    0.48      0    50.94    0.32    0.48      0
       32768          8192     float     sum      -1    71.03    0.46    0.69      0    68.89    0.48    0.71      0
       65536         16384     float     sum      -1    90.28    0.73    1.09      0    89.88    0.73    1.09      0
      131072         32768     float     sum      -1    114.9    1.14    1.71      0    113.5    1.16    1.73      0
      262144         65536     float     sum      -1    166.5    1.57    2.36      0    165.3    1.59    2.38      0
      524288        131072     float     sum      -1    266.5    1.97    2.95      0    267.1    1.96    2.94      0
     1048576        262144     float     sum      -1    412.2    2.54    3.82      0    411.0    2.55    3.83      0
     2097152        524288     float     sum      -1    742.3    2.83    4.24      0    743.0    2.82    4.23      0
     4194304       1048576     float     sum      -1   1335.6    3.14    4.71      0   1308.3    3.21    4.81      0
     8388608       2097152     float     sum      -1   2383.7    3.52    5.28      0   2384.3    3.52    5.28      0
    16777216       4194304     float     sum      -1   4594.5    3.65    5.48      0   4590.4    3.65    5.48      0
    33554432       8388608     float     sum      -1   9009.4    3.72    5.59      0   9031.9    3.72    5.57      0
    67108864      16777216     float     sum      -1    17818    3.77    5.65      0    17825    3.76    5.65      0
   134217728      33554432     float     sum      -1    35464    3.78    5.68      0    35449    3.79    5.68      0
   268435456      67108864     float     sum      -1    70735    3.79    5.69      0    70676    3.80    5.70      0
   536870912     134217728     float     sum      -1   141228    3.80    5.70      0   141177    3.80    5.70      0
x3209c0s13b0n0:30570:30570 [1] NCCL INFO comm 0x14e60601f010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:1542:1542 [1] NCCL INFO comm 0x150f2045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:30569:30569 [0] NCCL INFO comm 0x1544c045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1541:1541 [0] NCCL INFO comm 0x14a1da45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 3.08396 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30672 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  30673 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   1639 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   1640 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30672:30672 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30672:30672 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30672:30672 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30673:30673 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30673:30673 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30673:30673 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1640:1640 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1639:1639 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1640:1640 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1639:1639 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1640:1640 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1639:1639 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30672:30693 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30672:30693 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3209c0s13b0n0:30673:30721 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30673:30721 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30673:30721 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b1n0:1639:1730 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1639:1730 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3209c0s13b1n0:1640:1729 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1640:1729 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1640:1729 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:30673:30721 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:1640:1729 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1640:1729 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:1640:1729 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:30673:30721 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:30673:30721 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30672:30693 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30672:30693 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:30672:30693 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30672:30693 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30672:30693 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30672:30693 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30673:30721 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:30673:30721 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:30673:30721 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30673:30721 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30673:30721 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30673:30721 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1639:1730 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1639:1730 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:1639:1730 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1639:1730 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1639:1730 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1639:1730 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1640:1729 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:1640:1729 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:1640:1729 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1640:1729 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1640:1729 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1640:1729 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30672:30693 [0] NCCL INFO comm 0x1457ec45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30673:30721 [1] NCCL INFO comm 0x14f5c045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30672:30672 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:1639:1730 [0] NCCL INFO comm 0x14fc0a45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b1n0:1640:1729 [1] NCCL INFO comm 0x14be6a45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
        1024           256     float     sum      -1    45.02    0.02    0.03      0    44.86    0.02    0.03      0
        2048           512     float     sum      -1    46.55    0.04    0.07      0    46.62    0.04    0.07      0
        4096          1024     float     sum      -1    48.49    0.08    0.13      0    48.34    0.08    0.13      0
        8192          2048     float     sum      -1    47.62    0.17    0.26      0    47.29    0.17    0.26      0
       16384          4096     float     sum      -1    52.18    0.31    0.47      0    52.08    0.31    0.47      0
       32768          8192     float     sum      -1    63.87    0.51    0.77      0    63.67    0.51    0.77      0
       65536         16384     float     sum      -1    79.16    0.83    1.24      0    78.66    0.83    1.25      0
      131072         32768     float     sum      -1    106.0    1.24    1.85      0    104.8    1.25    1.88      0
      262144         65536     float     sum      -1    147.9    1.77    2.66      0    146.9    1.78    2.68      0
      524288        131072     float     sum      -1    230.4    2.28    3.41      0    231.1    2.27    3.40      0
     1048576        262144     float     sum      -1    327.1    3.21    4.81      0    327.2    3.20    4.81      0
     2097152        524288     float     sum      -1    575.5    3.64    5.47      0    575.6    3.64    5.47      0
     4194304       1048576     float     sum      -1    988.0    4.25    6.37      0   1014.0    4.14    6.20      0
     8388608       2097152     float     sum      -1   1798.9    4.66    6.99      0   1796.6    4.67    7.00      0
    16777216       4194304     float     sum      -1   3426.0    4.90    7.35      0   3423.4    4.90    7.35      0
    33554432       8388608     float     sum      -1   6661.6    5.04    7.56      0   6658.2    5.04    7.56      0
    67108864      16777216     float     sum      -1    13155    5.10    7.65      0    13129    5.11    7.67      0
   134217728      33554432     float     sum      -1    26066    5.15    7.72      0    26062    5.15    7.72      0
   268435456      67108864     float     sum      -1    51915    5.17    7.76      0    51927    5.17    7.75      0
   536870912     134217728     float     sum      -1   103655    5.18    7.77      0   103631    5.18    7.77      0
x3209c0s13b0n0:30673:30673 [1] NCCL INFO comm 0x14f5c045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:1640:1640 [1] NCCL INFO comm 0x14be6a45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:30672:30672 [0] NCCL INFO comm 0x1457ec45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1639:1639 [0] NCCL INFO comm 0x14fc0a45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 4.01443 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30772 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  30773 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   1740 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   1741 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30772:30772 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30772:30772 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30772:30772 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30773:30773 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30773:30773 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30773:30773 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1741:1741 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1740:1740 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1741:1741 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1740:1740 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1741:1741 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:1740:1740 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30773:30811 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30773:30811 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30773:30811 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3209c0s13b0n0:30772:30793 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30772:30793 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3209c0s13b1n0:1740:1823 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1740:1823 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3209c0s13b1n0:1741:1821 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1741:1821 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3209c0s13b1n0:1741:1821 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:1741:1821 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:30773:30811 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30773:30811 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:30773:30811 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1741:1821 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:1741:1821 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1740:1823 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1740:1823 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:1740:1823 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1740:1823 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1740:1823 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1740:1823 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1741:1821 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:1741:1821 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:1741:1821 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1741:1821 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b1n0:1741:1821 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1741:1821 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30772:30793 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30772:30793 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:30772:30793 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30772:30793 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30772:30793 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30772:30793 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b0n0:30773:30811 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:30773:30811 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:30773:30811 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30773:30811 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3209c0s13b0n0:30773:30811 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30773:30811 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3209c0s13b1n0:1740:1823 [0] NCCL INFO comm 0x14a70a45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b1n0:1741:1821 [1] NCCL INFO comm 0x1511d645a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30773:30811 [1] NCCL INFO comm 0x1498605cf010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:30772:30793 [0] NCCL INFO comm 0x15461045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30772:30772 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    45.52    0.02    0.03      0    44.82    0.02    0.03      0
        2048           512     float     sum      -1    46.39    0.04    0.07      0    46.15    0.04    0.07      0
        4096          1024     float     sum      -1    48.42    0.08    0.13      0    48.54    0.08    0.13      0
        8192          2048     float     sum      -1    47.40    0.17    0.26      0    46.99    0.17    0.26      0
       16384          4096     float     sum      -1    52.27    0.31    0.47      0    51.95    0.32    0.47      0
       32768          8192     float     sum      -1    67.18    0.49    0.73      0    66.93    0.49    0.73      0
       65536         16384     float     sum      -1    83.65    0.78    1.18      0    82.96    0.79    1.18      0
      131072         32768     float     sum      -1    99.18    1.32    1.98      0    100.7    1.30    1.95      0
      262144         65536     float     sum      -1    133.0    1.97    2.96      0    132.1    1.99    2.98      0
      524288        131072     float     sum      -1    200.8    2.61    3.92      0    201.7    2.60    3.90      0
     1048576        262144     float     sum      -1    310.6    3.38    5.06      0    310.3    3.38    5.07      0
     2097152        524288     float     sum      -1    538.6    3.89    5.84      0    536.1    3.91    5.87      0
     4194304       1048576     float     sum      -1    915.4    4.58    6.87      0    914.6    4.59    6.88      0
     8388608       2097152     float     sum      -1   1537.1    5.46    8.19      0   1534.7    5.47    8.20      0
    16777216       4194304     float     sum      -1   2921.3    5.74    8.61      0   2894.3    5.80    8.69      0
    33554432       8388608     float     sum      -1   5597.7    5.99    8.99      0   5594.2    6.00    9.00      0
    67108864      16777216     float     sum      -1    10992    6.11    9.16      0    10989    6.11    9.16      0
   134217728      33554432     float     sum      -1    21797    6.16    9.24      0    21744    6.17    9.26      0
   268435456      67108864     float     sum      -1    43306    6.20    9.30      0    43269    6.20    9.31      0
   536870912     134217728     float     sum      -1    86373    6.22    9.32      0    86315    6.22    9.33      0
x3209c0s13b0n0:30773:30773 [1] NCCL INFO comm 0x1498605cf010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:1741:1741 [1] NCCL INFO comm 0x1511d645a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:1740:1740 [0] NCCL INFO comm 0x14a70a45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b0n0:30772:30772 [0] NCCL INFO comm 0x15461045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 0 OK
# Avg bus bandwidth    : 4.61936 
#

NCCL TEST with MSCCL 1 channel 2gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  30874 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   1839 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:30874:30874 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:30874:30874 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:30874:30874 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:1839:1839 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:1839:1839 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:1839:1839 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 00/02 :    0   1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 01/02 :    0   1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:1839:1854 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:1839:1854 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:30874:30890 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:30874:30890 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:1839:1854 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:1839:1854 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:1839:1854 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:1839:1854 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:1839:1854 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:1839:1854 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:30874:30890 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:30874:30890 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:30874:30890 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:30874:30890 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:30874:30890 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:30874:30890 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:1839:1854 [0] NCCL INFO comm 0x153d8a259010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:30874:30890 [0] NCCL INFO comm 0x14b3c645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:30874:30874 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    35.78    0.03    0.03    512    35.63    0.03    0.03      0
        2048           512     float     sum      -1    38.83    0.05    0.05   1024    38.62    0.05    0.05      0
        4096          1024     float     sum      -1    38.42    0.11    0.11   2048    38.36    0.11    0.11      0
        8192          2048     float     sum      -1    39.86    0.21    0.21   4096    40.04    0.20    0.20      0
       16384          4096     float     sum      -1    47.49    0.34    0.34   8192    47.25    0.35    0.35      0
       32768          8192     float     sum      -1    66.27    0.49    0.49  16384    66.08    0.50    0.50      0
       65536         16384     float     sum      -1    93.58    0.70    0.70  32768    93.03    0.70    0.70      0
      131072         32768     float     sum      -1    147.1    0.89    0.89  65536    147.3    0.89    0.89      0
      262144         65536     float     sum      -1    254.7    1.03    1.03  131072    256.5    1.02    1.02      0
      524288        131072     float     sum      -1    471.1    1.11    1.11  262144    475.1    1.10    1.10      0
     1048576        262144     float     sum      -1    735.3    1.43    1.43  524288    734.9    1.43    1.43      0
     2097152        524288     float     sum      -1   1250.7    1.68    1.68  1.04858e+06   1251.7    1.68    1.68      0
     4194304       1048576     float     sum      -1   2288.2    1.83    1.83  2.09715e+06   2287.5    1.83    1.83      0
     8388608       2097152     float     sum      -1   4374.1    1.92    1.92  4.1943e+06   4374.0    1.92    1.92      0
    16777216       4194304     float     sum      -1   8548.3    1.96    1.96  8.38861e+06   8538.6    1.96    1.96      0
    33554432       8388608     float     sum      -1    16894    1.99    1.99  1.67772e+07    16893    1.99    1.99      0
    67108864      16777216     float     sum      -1    33601    2.00    2.00  3.35544e+07    33598    2.00    2.00      0
   134217728      33554432     float     sum      -1    66997    2.00    2.00  6.71088e+07    66991    2.00    2.00      0
   268435456      67108864     float     sum      -1   133766    2.01    2.01  1.34218e+08   133752    2.01    2.01      0
   536870912     134217728     float     sum      -1   267316    2.01    2.01  2.68435e+08   267335    2.01    2.01      0
x3209c0s13b0n0:30874:30874 [0] NCCL INFO comm 0x14b3c645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:1839:1839 [0] NCCL INFO comm 0x153d8a259010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 1.18904 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31119 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   2078 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31119:31119 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31119:31119 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31119:31119 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2078:2078 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2078:2078 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2078:2078 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 00/02 :    0   1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 01/02 :    0   1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31119:31135 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31119:31135 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31119:31135 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31119:31135 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:31119:31135 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31119:31135 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31119:31135 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31119:31135 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2078:2093 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2078:2093 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2078:2093 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2078:2093 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:2078:2093 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2078:2093 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2078:2093 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2078:2093 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31119:31135 [0] NCCL INFO comm 0x145db1328010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31119:31119 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:2078:2093 [0] NCCL INFO comm 0x14ff0c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    37.77    0.03    0.03    512    37.77    0.03    0.03      0
        2048           512     float     sum      -1    38.34    0.05    0.05   1024    38.27    0.05    0.05      0
        4096          1024     float     sum      -1    40.49    0.10    0.10   2048    40.42    0.10    0.10      0
        8192          2048     float     sum      -1    41.99    0.20    0.20   4096    41.93    0.20    0.20      0
       16384          4096     float     sum      -1    44.36    0.37    0.37   8192    44.26    0.37    0.37      0
       32768          8192     float     sum      -1    58.11    0.56    0.56  16384    57.78    0.57    0.57      0
       65536         16384     float     sum      -1    73.74    0.89    0.89  32768    73.61    0.89    0.89      0
      131072         32768     float     sum      -1    104.8    1.25    1.25  65536    105.0    1.25    1.25      0
      262144         65536     float     sum      -1    165.9    1.58    1.58  131072    167.5    1.57    1.57      0
      524288        131072     float     sum      -1    289.6    1.81    1.81  262144    290.6    1.80    1.80      0
     1048576        262144     float     sum      -1    430.1    2.44    2.44  524288    428.3    2.45    2.45      0
     2097152        524288     float     sum      -1    702.8    2.98    2.98  1.04858e+06    702.6    2.98    2.98      0
     4194304       1048576     float     sum      -1   1256.8    3.34    3.34  2.09715e+06   1255.4    3.34    3.34      0
     8388608       2097152     float     sum      -1   2366.7    3.54    3.54  4.1943e+06   2367.3    3.54    3.54      0
    16777216       4194304     float     sum      -1   4608.4    3.64    3.64  8.38861e+06   4591.9    3.65    3.65      0
    33554432       8388608     float     sum      -1   9046.4    3.71    3.71  1.67772e+07   9050.8    3.71    3.71      0
    67108864      16777216     float     sum      -1    17956    3.74    3.74  3.35544e+07    17955    3.74    3.74      0
   134217728      33554432     float     sum      -1    35763    3.75    3.75  6.71088e+07    35768    3.75    3.75      0
   268435456      67108864     float     sum      -1    71396    3.76    3.76  1.34218e+08    71393    3.76    3.76      0
   536870912     134217728     float     sum      -1   142664    3.76    3.76  2.68435e+08   142679    3.76    3.76      0
x3209c0s13b0n0:31119:31119 [0] NCCL INFO comm 0x145db1328010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2078:2078 [0] NCCL INFO comm 0x14ff0c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 2.0755 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31217 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   2172 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31217:31217 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31217:31217 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31217:31217 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2172:2172 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2172:2172 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2172:2172 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 00/02 :    0   1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 01/02 :    0   1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31217:31233 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31217:31233 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31217:31233 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31217:31233 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:31217:31233 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31217:31233 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31217:31233 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31217:31233 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2172:2187 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2172:2187 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2172:2187 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2172:2187 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:2172:2187 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2172:2187 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2172:2187 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2172:2187 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31217:31233 [0] NCCL INFO comm 0x151870259010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31217:31217 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:2172:2187 [0] NCCL INFO comm 0x152220470010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    37.10    0.03    0.03    512    37.17    0.03    0.03      0
        2048           512     float     sum      -1    38.72    0.05    0.05   1024    38.57    0.05    0.05      0
        4096          1024     float     sum      -1    39.29    0.10    0.10   2048    39.30    0.10    0.10      0
        8192          2048     float     sum      -1    40.89    0.20    0.20   4096    40.95    0.20    0.20      0
       16384          4096     float     sum      -1    43.80    0.37    0.37   8192    43.55    0.38    0.38      0
       32768          8192     float     sum      -1    52.95    0.62    0.62  16384    52.75    0.62    0.62      0
       65536         16384     float     sum      -1    63.59    1.03    1.03  32768    63.21    1.04    1.04      0
      131072         32768     float     sum      -1    82.81    1.58    1.58  65536    82.82    1.58    1.58      0
      262144         65536     float     sum      -1    122.1    2.15    2.15  131072    122.4    2.14    2.14      0
      524288        131072     float     sum      -1    200.1    2.62    2.62  262144    202.4    2.59    2.59      0
     1048576        262144     float     sum      -1    282.5    3.71    3.71  524288    282.4    3.71    3.71      0
     2097152        524288     float     sum      -1    439.4    4.77    4.77  1.04858e+06    439.7    4.77    4.77      0
     4194304       1048576     float     sum      -1    756.9    5.54    5.54  2.09715e+06    755.4    5.55    5.55      0
     8388608       2097152     float     sum      -1   1385.7    6.05    6.05  4.1943e+06   1387.4    6.05    6.05      0
    16777216       4194304     float     sum      -1   2686.7    6.24    6.24  8.38861e+06   2661.8    6.30    6.30      0
    33554432       8388608     float     sum      -1   5223.2    6.42    6.42  1.67772e+07   5220.5    6.43    6.43      0
    67108864      16777216     float     sum      -1    10343    6.49    6.49  3.35544e+07    10343    6.49    6.49      0
   134217728      33554432     float     sum      -1    20595    6.52    6.52  6.71088e+07    20593    6.52    6.52      0
   268435456      67108864     float     sum      -1    41118    6.53    6.53  1.34218e+08    41125    6.53    6.53      0
   536870912     134217728     float     sum      -1    82255    6.53    6.53  2.68435e+08    82279    6.52    6.52      0
x3209c0s13b0n0:31217:31217 [0] NCCL INFO comm 0x151870259010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2172:2172 [0] NCCL INFO comm 0x152220470010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.37929 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31309 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   2260 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31309:31309 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31309:31309 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31309:31309 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2260:2260 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2260:2260 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2260:2260 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 00/02 :    0   1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 01/02 :    0   1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2260:2275 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2260:2275 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2260:2275 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2260:2275 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:2260:2275 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2260:2275 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2260:2275 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2260:2275 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31309:31325 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31309:31325 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31309:31325 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31309:31325 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:31309:31325 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31309:31325 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31309:31325 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31309:31325 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2260:2275 [0] NCCL INFO comm 0x15280045a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:31309:31325 [0] NCCL INFO comm 0x15164045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31309:31309 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    41.29    0.02    0.02    512    41.15    0.02    0.02      0
        2048           512     float     sum      -1    42.59    0.05    0.05   1024    42.22    0.05    0.05      0
        4096          1024     float     sum      -1    43.29    0.09    0.09   2048    43.46    0.09    0.09      0
        8192          2048     float     sum      -1    45.09    0.18    0.18   4096    44.81    0.18    0.18      0
       16384          4096     float     sum      -1    47.39    0.35    0.35   8192    47.17    0.35    0.35      0
       32768          8192     float     sum      -1    56.10    0.58    0.58  16384    56.26    0.58    0.58      0
       65536         16384     float     sum      -1    63.39    1.03    1.03  32768    63.34    1.03    1.03      0
      131072         32768     float     sum      -1    79.51    1.65    1.65  65536    79.54    1.65    1.65      0
      262144         65536     float     sum      -1    111.6    2.35    2.35  131072    111.7    2.35    2.35      0
      524288        131072     float     sum      -1    174.4    3.01    3.01  262144    175.0    3.00    3.00      0
     1048576        262144     float     sum      -1    239.1    4.39    4.39  524288    235.4    4.45    4.45      0
     2097152        524288     float     sum      -1    350.3    5.99    5.99  1.04858e+06    351.6    5.97    5.97      0
     4194304       1048576     float     sum      -1    574.7    7.30    7.30  2.09715e+06    574.7    7.30    7.30      0
     8388608       2097152     float     sum      -1   1022.5    8.20    8.20  4.1943e+06   1020.6    8.22    8.22      0
    16777216       4194304     float     sum      -1   1949.7    8.60    8.60  8.38861e+06   1922.1    8.73    8.73      0
    33554432       8388608     float     sum      -1   3723.3    9.01    9.01  1.67772e+07   3723.0    9.01    9.01      0
    67108864      16777216     float     sum      -1   7304.2    9.19    9.19  3.35544e+07   7311.9    9.18    9.18      0
   134217728      33554432     float     sum      -1    14481    9.27    9.27  6.71088e+07    14489    9.26    9.26      0
   268435456      67108864     float     sum      -1    28851    9.30    9.30  1.34218e+08    28843    9.31    9.31      0
   536870912     134217728     float     sum      -1    57219    9.38    9.38  2.68435e+08    57227    9.38    9.38      0
x3209c0s13b0n0:31309:31309 [0] NCCL INFO comm 0x15164045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2260:2260 [0] NCCL INFO comm 0x15280045a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 4.50165 
#

NCCL TEST with MSCCL 1 channel 4gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31335 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  31336 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   2282 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   2283 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31335:31335 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31335:31335 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31335:31335 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31336:31336 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31336:31336 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31336:31336 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2282:2282 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2283:2283 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2282:2282 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2283:2283 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2283:2283 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2282:2282 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/3/-1->1->-1 [2] -1/-1/-1->1->0 [3] 0/-1/-1->1->3
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] -1/-1/-1->2->3 [2] 3/0/-1->2->-1 [3] -1/-1/-1->2->3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 00/04 :    0   1   2   3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 01/04 :    0   3   2   1
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 02/04 :    0   1   2   3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 03/04 :    0   3   2   1
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->2 [3] -1/-1/-1->0->1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 2/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 2/1/-1->3->-1
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 02 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 02 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 01 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 03 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 01 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 03 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 01 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 01 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 03 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 03 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Channel 02 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Channel 02 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2282:2301 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2282:2301 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:2283:2300 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2283:2300 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31335:31354 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31335:31354 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2283:2300 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2283:2300 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:2283:2300 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2283:2300 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2283:2300 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2283:2300 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2282:2301 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2282:2301 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b1n0:2282:2301 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2282:2301 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2282:2301 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2282:2301 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31335:31354 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31335:31354 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:31335:31354 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31335:31354 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31335:31354 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31335:31354 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:31336:31355 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31336:31355 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31336:31355 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31336:31355 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3209c0s13b0n0:31336:31355 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31336:31355 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31336:31355 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31336:31355 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31336:31355 [1] NCCL INFO comm 0x154bc0cda010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:31335:31354 [0] NCCL INFO comm 0x14d4c99ee010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31335:31335 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:2282:2301 [0] NCCL INFO comm 0x14bae045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b1n0:2283:2300 [1] NCCL INFO comm 0x149b8a01f010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
        1024           256     float     sum      -1    52.46    0.02    0.03   1024    52.50    0.02    0.03      0
        2048           512     float     sum      -1    57.53    0.04    0.05   2048    59.47    0.03    0.05      0
        4096          1024     float     sum      -1    54.53    0.08    0.11   4096    54.76    0.07    0.11      0
        8192          2048     float     sum      -1    56.77    0.14    0.22   8192    57.12    0.14    0.22      0
       16384          4096     float     sum      -1    67.49    0.24    0.36  16384    67.55    0.24    0.36      0
       32768          8192     float     sum      -1    92.12    0.36    0.53  32768    92.15    0.36    0.53      0
       65536         16384     float     sum      -1    130.2    0.50    0.76  65536    130.4    0.50    0.75      0
      131072         32768     float     sum      -1    206.7    0.63    0.95  131072    207.5    0.63    0.95      0
      262144         65536     float     sum      -1    359.6    0.73    1.09  262144    360.3    0.73    1.09      0
      524288        131072     float     sum      -1    663.7    0.79    1.18  524288    668.3    0.78    1.18      0
     1048576        262144     float     sum      -1    844.3    1.24    1.86  1.04858e+06    844.2    1.24    1.86      0
     2097152        524288     float     sum      -1   1201.5    1.75    2.62  2.09715e+06   1202.4    1.74    2.62      0
     4194304       1048576     float     sum      -1   1914.0    2.19    3.29  4.1943e+06   1912.4    2.19    3.29      0
     8388608       2097152     float     sum      -1   3332.1    2.52    3.78  8.38861e+06   3332.5    2.52    3.78      0
    16777216       4194304     float     sum      -1   6175.7    2.72    4.08  1.67772e+07   6163.6    2.72    4.08      0
    33554432       8388608     float     sum      -1    11823    2.84    4.26  3.35544e+07    11823    2.84    4.26      0
    67108864      16777216     float     sum      -1    23147    2.90    4.35  6.71088e+07    23144    2.90    4.35      0
   134217728      33554432     float     sum      -1    45784    2.93    4.40  1.34218e+08    45780    2.93    4.40      0
   268435456      67108864     float     sum      -1    91056    2.95    4.42  2.68435e+08    91058    2.95    4.42      0
   536870912     134217728     float     sum      -1   181625    2.96    4.43  5.36871e+08   181626    2.96    4.43      0
x3209c0s13b0n0:31336:31336 [1] NCCL INFO comm 0x154bc0cda010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:31335:31335 [0] NCCL INFO comm 0x14d4c99ee010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2282:2282 [0] NCCL INFO comm 0x14bae045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2283:2283 [1] NCCL INFO comm 0x149b8a01f010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 2.13839 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31512 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  31513 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   2455 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   2456 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31512:31512 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31512:31512 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31512:31512 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31513:31513 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31513:31513 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31513:31513 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2456:2456 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2456:2456 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2455:2455 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2455:2455 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2456:2456 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2455:2455 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/3/-1->1->-1 [2] -1/-1/-1->1->0 [3] 0/-1/-1->1->3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 00/04 :    0   1   2   3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 01/04 :    0   3   2   1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 02/04 :    0   1   2   3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 03/04 :    0   3   2   1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->2 [3] -1/-1/-1->0->1
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] -1/-1/-1->2->3 [2] 3/0/-1->2->-1 [3] -1/-1/-1->2->3
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 2/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 2/1/-1->3->-1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 02 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 02 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 01 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 03 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 01 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 03 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 01 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 01 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 03 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 03 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Channel 02 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Channel 02 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2455:2474 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2455:2474 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:2456:2473 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2456:2473 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2455:2474 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2455:2474 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:2455:2474 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2455:2474 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2455:2474 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2455:2474 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2456:2473 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2456:2473 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b1n0:2456:2473 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2456:2473 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2456:2473 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2456:2473 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:31513:31532 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31512:31531 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31512:31531 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31513:31532 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31512:31531 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31513:31532 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31513:31532 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:31513:31532 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31513:31532 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31513:31532 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31513:31532 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31512:31531 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3209c0s13b0n0:31512:31531 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31512:31531 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31512:31531 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31512:31531 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2456:2473 [1] NCCL INFO comm 0x145b5045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b1n0:2455:2474 [0] NCCL INFO comm 0x14d3fcb7e010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:31512:31531 [0] NCCL INFO comm 0x14687c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31513:31532 [1] NCCL INFO comm 0x14b32045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:31512:31512 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    55.06    0.02    0.03   1024    54.84    0.02    0.03      0
        2048           512     float     sum      -1    55.48    0.04    0.06   2048    55.57    0.04    0.06      0
        4096          1024     float     sum      -1    57.59    0.07    0.11   4096    57.45    0.07    0.11      0
        8192          2048     float     sum      -1    59.35    0.14    0.21   8192    59.45    0.14    0.21      0
       16384          4096     float     sum      -1    63.09    0.26    0.39  16384    63.19    0.26    0.39      0
       32768          8192     float     sum      -1    79.95    0.41    0.61  32768    80.17    0.41    0.61      0
       65536         16384     float     sum      -1    102.6    0.64    0.96  65536    102.7    0.64    0.96      0
      131072         32768     float     sum      -1    146.6    0.89    1.34  131072    146.7    0.89    1.34      0
      262144         65536     float     sum      -1    233.3    1.12    1.69  262144    234.5    1.12    1.68      0
      524288        131072     float     sum      -1    408.5    1.28    1.93  524288    411.0    1.28    1.91      0
     1048576        262144     float     sum      -1    514.2    2.04    3.06  1.04858e+06    513.4    2.04    3.06      0
     2097152        524288     float     sum      -1    725.9    2.89    4.33  2.09715e+06    724.0    2.90    4.34      0
     4194304       1048576     float     sum      -1   1147.6    3.65    5.48  4.1943e+06   1147.5    3.66    5.48      0
     8388608       2097152     float     sum      -1   1980.5    4.24    6.35  8.38861e+06   1978.9    4.24    6.36      0
    16777216       4194304     float     sum      -1   3661.1    4.58    6.87  1.67772e+07   3643.2    4.61    6.91      0
    33554432       8388608     float     sum      -1   6963.0    4.82    7.23  3.35544e+07   6961.2    4.82    7.23      0
    67108864      16777216     float     sum      -1    13599    4.93    7.40  6.71088e+07    13599    4.93    7.40      0
   134217728      33554432     float     sum      -1    26875    4.99    7.49  1.34218e+08    26871    4.99    7.49      0
   268435456      67108864     float     sum      -1    53420    5.02    7.54  2.68435e+08    53414    5.03    7.54      0
   536870912     134217728     float     sum      -1   106512    5.04    7.56  5.36871e+08   106514    5.04    7.56      0
x3209c0s13b1n0:2456:2456 [1] NCCL INFO comm 0x145b5045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:2455:2455 [0] NCCL INFO comm 0x14d3fcb7e010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b0n0:31513:31513 [1] NCCL INFO comm 0x14b32045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:31512:31512 [0] NCCL INFO comm 0x14687c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 3.53253 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31614 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  31615 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   2554 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   2555 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31614:31614 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31614:31614 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31614:31614 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31615:31615 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31615:31615 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31615:31615 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2555:2555 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2554:2554 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2555:2555 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2554:2554 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2555:2555 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2554:2554 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 00/04 :    0   1   2   3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 01/04 :    0   3   2   1
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 02/04 :    0   1   2   3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 03/04 :    0   3   2   1
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->2 [3] -1/-1/-1->0->1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/3/-1->1->-1 [2] -1/-1/-1->1->0 [3] 0/-1/-1->1->3
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 2/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 2/1/-1->3->-1
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] -1/-1/-1->2->3 [2] 3/0/-1->2->-1 [3] -1/-1/-1->2->3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 02 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 02 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 01 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 01 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 03 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 03 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 01 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 01 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 03 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 03 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Channel 02 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Channel 02 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2554:2573 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2554:2573 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:2555:2572 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2555:2572 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2554:2573 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2554:2573 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:2554:2573 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2554:2573 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2554:2573 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2554:2573 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2555:2572 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2555:2572 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b1n0:2555:2572 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2555:2572 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2555:2572 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2555:2572 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:31615:31635 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31614:31634 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31614:31634 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31615:31635 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31614:31634 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31614:31634 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:31615:31635 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31615:31635 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3209c0s13b0n0:31615:31635 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31615:31635 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31615:31635 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31615:31635 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31614:31634 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31614:31634 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31614:31634 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31614:31634 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31614:31634 [0] NCCL INFO comm 0x151b3c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31615:31635 [1] NCCL INFO comm 0x154f8c45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:31614:31614 [0] NCCL INFO Launch mode Parallel
x3209c0s13b1n0:2555:2572 [1] NCCL INFO comm 0x151bbc45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b1n0:2554:2573 [0] NCCL INFO comm 0x1536dc45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    52.78    0.02    0.03   1024    52.65    0.02    0.03      0
        2048           512     float     sum      -1    54.36    0.04    0.06   2048    54.32    0.04    0.06      0
        4096          1024     float     sum      -1    54.21    0.08    0.11   4096    54.32    0.08    0.11      0
        8192          2048     float     sum      -1    56.18    0.15    0.22   8192    56.47    0.15    0.22      0
       16384          4096     float     sum      -1    60.85    0.27    0.40  16384    60.68    0.27    0.40      0
       32768          8192     float     sum      -1    71.69    0.46    0.69  32768    71.48    0.46    0.69      0
       65536         16384     float     sum      -1    87.92    0.75    1.12  65536    86.28    0.76    1.14      0
      131072         32768     float     sum      -1    114.4    1.15    1.72  131072    115.0    1.14    1.71      0
      262144         65536     float     sum      -1    169.9    1.54    2.31  262144    169.8    1.54    2.32      0
      524288        131072     float     sum      -1    280.7    1.87    2.80  524288    280.8    1.87    2.80      0
     1048576        262144     float     sum      -1    349.0    3.00    4.51  1.04858e+06    347.1    3.02    4.53      0
     2097152        524288     float     sum      -1    482.9    4.34    6.51  2.09715e+06    483.5    4.34    6.51      0
     4194304       1048576     float     sum      -1    761.7    5.51    8.26  4.1943e+06    762.1    5.50    8.26      0
     8388608       2097152     float     sum      -1   1321.3    6.35    9.52  8.38861e+06   1322.7    6.34    9.51      0
    16777216       4194304     float     sum      -1   2436.8    6.88   10.33  1.67772e+07   2415.0    6.95   10.42      0
    33554432       8388608     float     sum      -1   4589.1    7.31   10.97  3.35544e+07   4584.9    7.32   10.98      0
    67108864      16777216     float     sum      -1   8932.0    7.51   11.27  6.71088e+07   8931.1    7.51   11.27      0
   134217728      33554432     float     sum      -1    17615    7.62   11.43  1.34218e+08    17610    7.62   11.43      0
   268435456      67108864     float     sum      -1    34982    7.67   11.51  2.68435e+08    34987    7.67   11.51      0
   536870912     134217728     float     sum      -1    69691    7.70   11.56  5.36871e+08    69700    7.70   11.55      0
x3209c0s13b1n0:2555:2555 [1] NCCL INFO comm 0x151bbc45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:2554:2554 [0] NCCL INFO comm 0x1536dc45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b0n0:31615:31615 [1] NCCL INFO comm 0x154f8c45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:31614:31614 [0] NCCL INFO comm 0x151b3c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 5.26922 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  31715 on x3209c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  31716 on x3209c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid   2650 on x3209c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid   2651 on x3209c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31715:31715 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31715:31715 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31715:31715 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b0n0:31716:31716 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.62<0>
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b0n0:31716:31716 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b0n0:31716:31716 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2651:2651 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2651:2651 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3209c0s13b1n0:2650:2650 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.64<0>
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3209c0s13b1n0:2650:2650 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3209c0s13b1n0:2651:2651 [1] NCCL INFO Using network AWS Libfabric
x3209c0s13b1n0:2650:2650 [0] NCCL INFO Using network AWS Libfabric
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 00/04 :    0   1   2   3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 01/04 :    0   3   2   1
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 02/04 :    0   1   2   3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 03/04 :    0   3   2   1
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->2 [3] -1/-1/-1->0->1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/3/-1->1->-1 [2] -1/-1/-1->1->0 [3] 0/-1/-1->1->3
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] -1/-1/-1->2->3 [2] 3/0/-1->2->-1 [3] -1/-1/-1->2->3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] 2/-1/-1->3->1 [2] -1/-1/-1->3->2 [3] 2/1/-1->3->-1
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 02 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 02 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 02/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 02/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 01/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 01/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 01 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 03 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 03/0 : 2[7000] -> 1[46000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 03/0 : 0[7000] -> 3[46000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 01 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 03 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Connected all rings
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 01 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Connected all rings
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Connected all rings
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 01 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Connected all rings
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 03 : 2[7000] -> 3[46000] via P2P/IPC/read
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 03 : 0[7000] -> 1[46000] via P2P/IPC/read
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [receive] via NET/AWS Libfabric/3
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Channel 02/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 01/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 03/0 : 3[46000] -> 1[46000] [send] via NET/AWS Libfabric/3
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Channel 02 : 3[46000] -> 2[7000] via P2P/IPC/read
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Channel 02 : 1[46000] -> 0[7000] via P2P/IPC/read
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Connected all trees
x3209c0s13b1n0:2651:2668 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2651:2668 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Connected all trees
x3209c0s13b1n0:2650:2669 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2650:2669 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2651:2668 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2651:2668 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:2651:2668 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2651:2668 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2651:2668 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2651:2668 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b1n0:2650:2669 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b1n0:2650:2669 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b1n0:2650:2669 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b1n0:2650:2669 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b1n0:2650:2669 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b1n0:2650:2669 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Connected all trees
x3209c0s13b0n0:31716:31735 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31716:31735 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Connected all trees
x3209c0s13b0n0:31715:31734 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31715:31734 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3209c0s13b0n0:31715:31734 [0] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31716:31735 [1] NCCL INFO Connected 1 MSCCL algorithms
x3209c0s13b0n0:31716:31735 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:31716:31735 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31716:31735 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31716:31735 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31716:31735 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b0n0:31715:31734 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3209c0s13b0n0:31715:31734 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3209c0s13b0n0:31715:31734 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3209c0s13b0n0:31715:31734 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3209c0s13b0n0:31715:31734 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3209c0s13b1n0:2651:2668 [1] NCCL INFO comm 0x1499914a7010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b1n0:2650:2669 [0] NCCL INFO comm 0x151c6045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3209c0s13b0n0:31716:31735 [1] NCCL INFO comm 0x14ac9445a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3209c0s13b0n0:31715:31734 [0] NCCL INFO comm 0x147120783010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3209c0s13b0n0:31715:31715 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    58.59    0.02    0.03   1024    58.19    0.02    0.03      0
        2048           512     float     sum      -1    59.71    0.03    0.05   2048    59.77    0.03    0.05      0
        4096          1024     float     sum      -1    59.80    0.07    0.10   4096    59.73    0.07    0.10      0
        8192          2048     float     sum      -1    62.13    0.13    0.20   8192    61.87    0.13    0.20      0
       16384          4096     float     sum      -1    65.59    0.25    0.37  16384    65.48    0.25    0.38      0
       32768          8192     float     sum      -1    77.28    0.42    0.64  32768    77.32    0.42    0.64      0
       65536         16384     float     sum      -1    87.42    0.75    1.12  65536    87.75    0.75    1.12      0
      131072         32768     float     sum      -1    111.7    1.17    1.76  131072    111.6    1.17    1.76      0
      262144         65536     float     sum      -1    157.8    1.66    2.49  262144    158.1    1.66    2.49      0
      524288        131072     float     sum      -1    250.8    2.09    3.14  524288    250.5    2.09    3.14      0
     1048576        262144     float     sum      -1    297.7    3.52    5.28  1.04858e+06    297.6    3.52    5.29      0
     2097152        524288     float     sum      -1    403.3    5.20    7.80  2.09715e+06    403.0    5.20    7.81      0
     4194304       1048576     float     sum      -1    620.1    6.76   10.15  4.1943e+06    621.1    6.75   10.13      0
     8388608       2097152     float     sum      -1   1051.4    7.98   11.97  8.38861e+06   1052.8    7.97   11.95      0
    16777216       4194304     float     sum      -1   1974.7    8.50   12.74  1.67772e+07   1945.3    8.62   12.94      0
    33554432       8388608     float     sum      -1   3827.9    8.77   13.15  3.35544e+07   3795.1    8.84   13.26      0
    67108864      16777216     float     sum      -1   7516.0    8.93   13.39  6.71088e+07   7513.2    8.93   13.40      0
   134217728      33554432     float     sum      -1    15016    8.94   13.41  1.34218e+08    15020    8.94   13.40      0
   268435456      67108864     float     sum      -1    30026    8.94   13.41  2.68435e+08    30039    8.94   13.40      0
   536870912     134217728     float     sum      -1    60055    8.94   13.41  5.36871e+08    60074    8.94   13.41      0
x3209c0s13b0n0:31715:31715 [0] NCCL INFO comm 0x147120783010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3209c0s13b1n0:2651:2651 [1] NCCL INFO comm 0x1499914a7010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b0n0:31716:31716 [1] NCCL INFO comm 0x14ac9445a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3209c0s13b1n0:2650:2650 [0] NCCL INFO comm 0x151c6045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 6.23738 
#

