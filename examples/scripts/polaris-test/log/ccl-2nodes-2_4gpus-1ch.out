NCCL TEST with MSCCL 1 channel 2gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28342 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62070 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28342:28342 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28342:28342 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28342:28342 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62070:62070 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62070:62070 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62070:62070 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28342:28355 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28342:28355 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28342:28355 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28342:28355 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:28342:28355 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28342:28355 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:28342:28355 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28342:28355 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62070:62082 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62070:62082 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62070:62082 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62070:62082 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:62070:62082 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62070:62082 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62070:62082 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62070:62082 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b0n0:28342:28355 [0] NCCL INFO comm 0x14666c45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28342:28342 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:62070:62082 [0] NCCL INFO comm 0x14c0ac45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    35.94    0.03    0.03    512    35.83    0.03    0.03      0
        2048           512     float     sum      -1    39.24    0.05    0.05   1024    39.01    0.05    0.05      0
        4096          1024     float     sum      -1    39.10    0.10    0.10   2048    38.89    0.11    0.11      0
        8192          2048     float     sum      -1    40.24    0.20    0.20   4096    40.13    0.20    0.20      0
       16384          4096     float     sum      -1    47.82    0.34    0.34   8192    47.82    0.34    0.34      0
       32768          8192     float     sum      -1    66.94    0.49    0.49  16384    67.10    0.49    0.49      0
       65536         16384     float     sum      -1    94.31    0.69    0.69  32768    93.99    0.70    0.70      0
      131072         32768     float     sum      -1    147.9    0.89    0.89  65536    147.6    0.89    0.89      0
      262144         65536     float     sum      -1    254.7    1.03    1.03  131072    257.1    1.02    1.02      0
      524288        131072     float     sum      -1    472.5    1.11    1.11  262144    475.7    1.10    1.10      0
     1048576        262144     float     sum      -1    736.5    1.42    1.42  524288    735.4    1.43    1.43      0
     2097152        524288     float     sum      -1   1253.8    1.67    1.67  1.04858e+06   1254.9    1.67    1.67      0
     4194304       1048576     float     sum      -1   2292.2    1.83    1.83  2.09715e+06   2293.7    1.83    1.83      0
     8388608       2097152     float     sum      -1   4377.3    1.92    1.92  4.1943e+06   4383.5    1.91    1.91      0
    16777216       4194304     float     sum      -1   8557.2    1.96    1.96  8.38861e+06   8545.0    1.96    1.96      0
    33554432       8388608     float     sum      -1    16892    1.99    1.99  1.67772e+07    16891    1.99    1.99      0
    67108864      16777216     float     sum      -1    33581    2.00    2.00  3.35544e+07    33580    2.00    2.00      0
   134217728      33554432     float     sum      -1    66937    2.01    2.01  6.71088e+07    66960    2.00    2.00      0
   268435456      67108864     float     sum      -1   133692    2.01    2.01  1.34218e+08   133672    2.01    2.01      0
   536870912     134217728     float     sum      -1   267146    2.01    2.01  2.68435e+08   267155    2.01    2.01      0
x3212c0s13b0n0:28342:28342 [0] NCCL INFO comm 0x14666c45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62070:62070 [0] NCCL INFO comm 0x14c0ac45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 1.18726 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28517 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62244 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28517:28517 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28517:28517 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28517:28517 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62244:62244 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62244:62244 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62244:62244 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62244:62257 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62244:62257 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62244:62257 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62244:62257 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:62244:62257 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62244:62257 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62244:62257 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62244:62257 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28517:28532 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28517:28532 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28517:28532 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28517:28532 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:28517:28532 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28517:28532 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:28517:28532 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28517:28532 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:62244:62257 [0] NCCL INFO comm 0x14d9da45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:28517:28532 [0] NCCL INFO comm 0x1509c15a2010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28517:28517 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    37.58    0.03    0.03    512    37.39    0.03    0.03      0
        2048           512     float     sum      -1    37.72    0.05    0.05   1024    37.81    0.05    0.05      0
        4096          1024     float     sum      -1    40.34    0.10    0.10   2048    40.26    0.10    0.10      0
        8192          2048     float     sum      -1    41.69    0.20    0.20   4096    41.70    0.20    0.20      0
       16384          4096     float     sum      -1    44.23    0.37    0.37   8192    44.11    0.37    0.37      0
       32768          8192     float     sum      -1    57.64    0.57    0.57  16384    57.46    0.57    0.57      0
       65536         16384     float     sum      -1    73.25    0.89    0.89  32768    72.90    0.90    0.90      0
      131072         32768     float     sum      -1    104.6    1.25    1.25  65536    103.6    1.27    1.27      0
      262144         65536     float     sum      -1    164.4    1.59    1.59  131072    165.2    1.59    1.59      0
      524288        131072     float     sum      -1    286.9    1.83    1.83  262144    289.2    1.81    1.81      0
     1048576        262144     float     sum      -1    426.5    2.46    2.46  524288    425.9    2.46    2.46      0
     2097152        524288     float     sum      -1    697.1    3.01    3.01  1.04858e+06    696.5    3.01    3.01      0
     4194304       1048576     float     sum      -1   1243.2    3.37    3.37  2.09715e+06   1242.5    3.38    3.38      0
     8388608       2097152     float     sum      -1   2344.4    3.58    3.58  4.1943e+06   2345.5    3.58    3.58      0
    16777216       4194304     float     sum      -1   4574.3    3.67    3.67  8.38861e+06   4556.4    3.68    3.68      0
    33554432       8388608     float     sum      -1   8986.8    3.73    3.73  1.67772e+07   8991.1    3.73    3.73      0
    67108864      16777216     float     sum      -1    17839    3.76    3.76  3.35544e+07    17837    3.76    3.76      0
   134217728      33554432     float     sum      -1    35541    3.78    3.78  6.71088e+07    35545    3.78    3.78      0
   268435456      67108864     float     sum      -1    70956    3.78    3.78  1.34218e+08    70956    3.78    3.78      0
   536870912     134217728     float     sum      -1   141813    3.79    3.79  2.68435e+08   141823    3.79    3.79      0
x3212c0s13b0n0:28517:28517 [0] NCCL INFO comm 0x1509c15a2010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62244:62244 [0] NCCL INFO comm 0x14d9da45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 2.09121 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28683 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62405 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28683:28683 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28683:28683 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28683:28683 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62405:62405 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62405:62405 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62405:62405 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28683:28698 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28683:28698 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62405:62420 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62405:62420 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28683:28698 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28683:28698 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:28683:28698 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28683:28698 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:28683:28698 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28683:28698 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62405:62420 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62405:62420 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:62405:62420 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62405:62420 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62405:62420 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62405:62420 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:62405:62420 [0] NCCL INFO comm 0x15222a45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:28683:28698 [0] NCCL INFO comm 0x151fe0ed6010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28683:28683 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    36.98    0.03    0.03    512    36.78    0.03    0.03      0
        2048           512     float     sum      -1    38.38    0.05    0.05   1024    38.60    0.05    0.05      0
        4096          1024     float     sum      -1    39.29    0.10    0.10   2048    39.26    0.10    0.10      0
        8192          2048     float     sum      -1    40.68    0.20    0.20   4096    40.54    0.20    0.20      0
       16384          4096     float     sum      -1    43.68    0.38    0.38   8192    43.54    0.38    0.38      0
       32768          8192     float     sum      -1    52.93    0.62    0.62  16384    52.86    0.62    0.62      0
       65536         16384     float     sum      -1    63.09    1.04    1.04  32768    63.23    1.04    1.04      0
      131072         32768     float     sum      -1    82.59    1.59    1.59  65536    82.45    1.59    1.59      0
      262144         65536     float     sum      -1    121.3    2.16    2.16  131072    121.7    2.15    2.15      0
      524288        131072     float     sum      -1    199.9    2.62    2.62  262144    199.9    2.62    2.62      0
     1048576        262144     float     sum      -1    282.3    3.72    3.72  524288    282.7    3.71    3.71      0
     2097152        524288     float     sum      -1    438.0    4.79    4.79  1.04858e+06    438.4    4.78    4.78      0
     4194304       1048576     float     sum      -1    752.4    5.57    5.57  2.09715e+06    752.1    5.58    5.58      0
     8388608       2097152     float     sum      -1   1378.9    6.08    6.08  4.1943e+06   1379.6    6.08    6.08      0
    16777216       4194304     float     sum      -1   2674.4    6.27    6.27  8.38861e+06   2644.6    6.34    6.34      0
    33554432       8388608     float     sum      -1   5195.9    6.46    6.46  1.67772e+07   5193.8    6.46    6.46      0
    67108864      16777216     float     sum      -1    10294    6.52    6.52  3.35544e+07    10288    6.52    6.52      0
   134217728      33554432     float     sum      -1    20489    6.55    6.55  6.71088e+07    20482    6.55    6.55      0
   268435456      67108864     float     sum      -1    40908    6.56    6.56  1.34218e+08    40894    6.56    6.56      0
   536870912     134217728     float     sum      -1    81805    6.56    6.56  2.68435e+08    81809    6.56    6.56      0
x3212c0s13b0n0:28683:28683 [0] NCCL INFO comm 0x151fe0ed6010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62405:62405 [0] NCCL INFO comm 0x15222a45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.39552 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28706 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62426 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28706:28706 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28706:28706 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28706:28706 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62426:62426 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62426:62426 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62426:62426 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62426:62441 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62426:62441 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62426:62441 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62426:62441 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:62426:62441 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62426:62441 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62426:62441 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62426:62441 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28706:28721 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28706:28721 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28706:28721 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28706:28721 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:28706:28721 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28706:28721 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:28706:28721 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28706:28721 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:62426:62441 [0] NCCL INFO comm 0x14827a45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:28706:28721 [0] NCCL INFO comm 0x14e4ac45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28706:28706 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    41.27    0.02    0.02    512    41.23    0.02    0.02      0
        2048           512     float     sum      -1    42.42    0.05    0.05   1024    42.46    0.05    0.05      0
        4096          1024     float     sum      -1    43.39    0.09    0.09   2048    43.37    0.09    0.09      0
        8192          2048     float     sum      -1    45.02    0.18    0.18   4096    44.71    0.18    0.18      0
       16384          4096     float     sum      -1    47.36    0.35    0.35   8192    47.55    0.34    0.34      0
       32768          8192     float     sum      -1    56.68    0.58    0.58  16384    56.65    0.58    0.58      0
       65536         16384     float     sum      -1    63.57    1.03    1.03  32768    63.35    1.03    1.03      0
      131072         32768     float     sum      -1    79.79    1.64    1.64  65536    79.72    1.64    1.64      0
      262144         65536     float     sum      -1    111.9    2.34    2.34  131072    111.7    2.35    2.35      0
      524288        131072     float     sum      -1    175.7    2.98    2.98  262144    174.7    3.00    3.00      0
     1048576        262144     float     sum      -1    236.5    4.43    4.43  524288    236.2    4.44    4.44      0
     2097152        524288     float     sum      -1    350.9    5.98    5.98  1.04858e+06    351.9    5.96    5.96      0
     4194304       1048576     float     sum      -1    577.3    7.26    7.26  2.09715e+06    576.5    7.28    7.28      0
     8388608       2097152     float     sum      -1   1024.2    8.19    8.19  4.1943e+06   1024.2    8.19    8.19      0
    16777216       4194304     float     sum      -1   1948.4    8.61    8.61  8.38861e+06   1919.7    8.74    8.74      0
    33554432       8388608     float     sum      -1   3711.9    9.04    9.04  1.67772e+07   3711.8    9.04    9.04      0
    67108864      16777216     float     sum      -1   7274.2    9.23    9.23  3.35544e+07   7274.3    9.23    9.23      0
   134217728      33554432     float     sum      -1    14398    9.32    9.32  6.71088e+07    14397    9.32    9.32      0
   268435456      67108864     float     sum      -1    28608    9.38    9.38  1.34218e+08    28603    9.38    9.38      0
   536870912     134217728     float     sum      -1    56938    9.43    9.43  2.68435e+08    56960    9.43    9.43      0
x3212c0s13b0n0:28706:28706 [0] NCCL INFO comm 0x14e4ac45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62426:62426 [0] NCCL INFO comm 0x14827a45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 4.51132 
#

NCCL TEST with NCCL_MSCCL 1 channel 2gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28801 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62518 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28801:28801 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28801:28801 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28801:28801 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62518:62518 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62518:62518 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62518:62518 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28801:28816 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:28801:28816 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Channel 00/01 :    0   1
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3212c0s13b1n0:62518:62533 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62518:62533 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28801:28816 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28801:28816 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28801:28816 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28801:28816 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:28801:28816 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28801:28816 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:28801:28816 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28801:28816 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62518:62533 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62518:62533 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62518:62533 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62518:62533 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:62518:62533 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62518:62533 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:62518:62533 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62518:62533 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:28801:28816 [0] NCCL INFO comm 0x14b5ec45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28801:28801 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:62518:62533 [0] NCCL INFO comm 0x14b99045a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    35.91    0.03    0.03    512    35.86    0.03    0.03      0
        2048           512     float     sum      -1    38.93    0.05    0.05   1024    38.94    0.05    0.05      0
        4096          1024     float     sum      -1    38.86    0.11    0.11   2048    38.64    0.11    0.11      0
        8192          2048     float     sum      -1    40.34    0.20    0.20   4096    40.29    0.20    0.20      0
       16384          4096     float     sum      -1    47.74    0.34    0.34   8192    47.61    0.34    0.34      0
       32768          8192     float     sum      -1    66.82    0.49    0.49  16384    66.97    0.49    0.49      0
       65536         16384     float     sum      -1    94.08    0.70    0.70  32768    93.99    0.70    0.70      0
      131072         32768     float     sum      -1    147.8    0.89    0.89  65536    147.9    0.89    0.89      0
      262144         65536     float     sum      -1    255.5    1.03    1.03  131072    257.4    1.02    1.02      0
      524288        131072     float     sum      -1    472.6    1.11    1.11  262144    475.8    1.10    1.10      0
     1048576        262144     float     sum      -1    738.1    1.42    1.42  524288    736.8    1.42    1.42      0
     2097152        524288     float     sum      -1   1253.0    1.67    1.67  1.04858e+06   1255.0    1.67    1.67      0
     4194304       1048576     float     sum      -1   2295.9    1.83    1.83  2.09715e+06   2297.0    1.83    1.83      0
     8388608       2097152     float     sum      -1   4377.8    1.92    1.92  4.1943e+06   4381.8    1.91    1.91      0
    16777216       4194304     float     sum      -1   8553.5    1.96    1.96  8.38861e+06   8557.0    1.96    1.96      0
    33554432       8388608     float     sum      -1    16911    1.98    1.98  1.67772e+07    16909    1.98    1.98      0
    67108864      16777216     float     sum      -1    33602    2.00    2.00  3.35544e+07    33604    2.00    2.00      0
   134217728      33554432     float     sum      -1    66984    2.00    2.00  6.71088e+07    66997    2.00    2.00      0
   268435456      67108864     float     sum      -1   133788    2.01    2.01  1.34218e+08   133761    2.01    2.01      0
   536870912     134217728     float     sum      -1   267335    2.01    2.01  2.68435e+08   267367    2.01    2.01      0
x3212c0s13b0n0:28801:28801 [0] NCCL INFO comm 0x14b5ec45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62518:62518 [0] NCCL INFO comm 0x14b99045a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 1.18658 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  28970 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62682 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:28970:28970 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:28970:28970 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:28970:28970 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62682:62682 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62682:62682 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62682:62682 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:28970:28985 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:28970:28985 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Channel 00/01 :    0   1
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3212c0s13b1n0:62682:62697 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62682:62697 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62682:62697 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62682:62697 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62682:62697 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62682:62697 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:62682:62697 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62682:62697 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:62682:62697 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62682:62697 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:28970:28985 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28970:28985 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:28970:28985 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:28970:28985 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:28970:28985 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:28970:28985 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:28970:28985 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:28970:28985 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62682:62697 [0] NCCL INFO comm 0x14c7a0ff4010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:28970:28985 [0] NCCL INFO comm 0x153b2645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:28970:28970 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    37.36    0.03    0.03    512    37.45    0.03    0.03      0
        2048           512     float     sum      -1    37.69    0.05    0.05   1024    37.55    0.05    0.05      0
        4096          1024     float     sum      -1    40.10    0.10    0.10   2048    40.04    0.10    0.10      0
        8192          2048     float     sum      -1    41.68    0.20    0.20   4096    41.72    0.20    0.20      0
       16384          4096     float     sum      -1    43.96    0.37    0.37   8192    43.84    0.37    0.37      0
       32768          8192     float     sum      -1    57.45    0.57    0.57  16384    57.51    0.57    0.57      0
       65536         16384     float     sum      -1    72.99    0.90    0.90  32768    72.95    0.90    0.90      0
      131072         32768     float     sum      -1    103.0    1.27    1.27  65536    103.2    1.27    1.27      0
      262144         65536     float     sum      -1    163.6    1.60    1.60  131072    164.7    1.59    1.59      0
      524288        131072     float     sum      -1    286.5    1.83    1.83  262144    289.8    1.81    1.81      0
     1048576        262144     float     sum      -1    424.3    2.47    2.47  524288    425.1    2.47    2.47      0
     2097152        524288     float     sum      -1    694.6    3.02    3.02  1.04858e+06    694.8    3.02    3.02      0
     4194304       1048576     float     sum      -1   1239.7    3.38    3.38  2.09715e+06   1239.5    3.38    3.38      0
     8388608       2097152     float     sum      -1   2338.2    3.59    3.59  4.1943e+06   2339.6    3.59    3.59      0
    16777216       4194304     float     sum      -1   4565.5    3.67    3.67  8.38861e+06   4549.2    3.69    3.69      0
    33554432       8388608     float     sum      -1   8955.3    3.75    3.75  1.67772e+07   8955.5    3.75    3.75      0
    67108864      16777216     float     sum      -1    17772    3.78    3.78  3.35544e+07    17777    3.78    3.78      0
   134217728      33554432     float     sum      -1    35417    3.79    3.79  6.71088e+07    35414    3.79    3.79      0
   268435456      67108864     float     sum      -1    70707    3.80    3.80  1.34218e+08    70698    3.80    3.80      0
   536870912     134217728     float     sum      -1   141301    3.80    3.80  2.68435e+08   141308    3.80    3.80      0
x3212c0s13b0n0:28970:28970 [0] NCCL INFO comm 0x153b2645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62682:62682 [0] NCCL INFO comm 0x14c7a0ff4010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 2.09787 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29134 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62844 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29134:29134 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29134:29134 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29134:29134 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62844:62844 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62844:62844 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62844:62844 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29134:29149 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29134:29149 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Channel 00/01 :    0   1
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3212c0s13b1n0:62844:62859 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62844:62859 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29134:29149 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29134:29149 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29134:29149 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29134:29149 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:29134:29149 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29134:29149 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29134:29149 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29134:29149 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62844:62859 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62844:62859 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62844:62859 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62844:62859 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:62844:62859 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62844:62859 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:62844:62859 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62844:62859 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29134:29149 [0] NCCL INFO comm 0x15513045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29134:29134 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:62844:62859 [0] NCCL INFO comm 0x15233845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    37.39    0.03    0.03    512    37.04    0.03    0.03      0
        2048           512     float     sum      -1    38.91    0.05    0.05   1024    39.00    0.05    0.05      0
        4096          1024     float     sum      -1    39.42    0.10    0.10   2048    39.43    0.10    0.10      0
        8192          2048     float     sum      -1    40.87    0.20    0.20   4096    40.86    0.20    0.20      0
       16384          4096     float     sum      -1    43.70    0.37    0.37   8192    43.58    0.38    0.38      0
       32768          8192     float     sum      -1    52.97    0.62    0.62  16384    52.73    0.62    0.62      0
       65536         16384     float     sum      -1    63.02    1.04    1.04  32768    63.08    1.04    1.04      0
      131072         32768     float     sum      -1    83.07    1.58    1.58  65536    82.64    1.59    1.59      0
      262144         65536     float     sum      -1    121.6    2.16    2.16  131072    121.9    2.15    2.15      0
      524288        131072     float     sum      -1    200.7    2.61    2.61  262144    200.7    2.61    2.61      0
     1048576        262144     float     sum      -1    284.2    3.69    3.69  524288    283.1    3.70    3.70      0
     2097152        524288     float     sum      -1    439.8    4.77    4.77  1.04858e+06    439.7    4.77    4.77      0
     4194304       1048576     float     sum      -1    754.1    5.56    5.56  2.09715e+06    753.5    5.57    5.57      0
     8388608       2097152     float     sum      -1   1380.7    6.08    6.08  4.1943e+06   1383.9    6.06    6.06      0
    16777216       4194304     float     sum      -1   2677.2    6.27    6.27  8.38861e+06   2650.9    6.33    6.33      0
    33554432       8388608     float     sum      -1   5201.6    6.45    6.45  1.67772e+07   5205.0    6.45    6.45      0
    67108864      16777216     float     sum      -1    10308    6.51    6.51  3.35544e+07    10306    6.51    6.51      0
   134217728      33554432     float     sum      -1    20515    6.54    6.54  6.71088e+07    20522    6.54    6.54      0
   268435456      67108864     float     sum      -1    40958    6.55    6.55  1.34218e+08    40950    6.56    6.56      0
   536870912     134217728     float     sum      -1    81885    6.56    6.56  2.68435e+08    81876    6.56    6.56      0
x3212c0s13b0n0:29134:29134 [0] NCCL INFO comm 0x15513045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62844:62844 [0] NCCL INFO comm 0x15233845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.38878 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29160 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  62867 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29160:29160 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29160:29160 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29160:29160 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62867:62867 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62867:62867 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62867:62867 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29160:29177 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29160:29177 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Channel 00/01 :    0   1
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1
x3212c0s13b1n0:62867:62884 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62867:62884 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62867:62884 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62867:62884 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62867:62884 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62867:62884 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:62867:62884 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62867:62884 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:62867:62884 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62867:62884 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29160:29177 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29160:29177 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29160:29177 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29160:29177 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:29160:29177 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29160:29177 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29160:29177 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29160:29177 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62867:62884 [0] NCCL INFO comm 0x14cf7645a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:29160:29177 [0] NCCL INFO comm 0x14adf045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29160:29160 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    41.05    0.02    0.02    512    40.89    0.03    0.03      0
        2048           512     float     sum      -1    42.09    0.05    0.05   1024    42.13    0.05    0.05      0
        4096          1024     float     sum      -1    43.44    0.09    0.09   2048    43.09    0.10    0.10      0
        8192          2048     float     sum      -1    44.89    0.18    0.18   4096    44.58    0.18    0.18      0
       16384          4096     float     sum      -1    47.28    0.35    0.35   8192    47.14    0.35    0.35      0
       32768          8192     float     sum      -1    56.26    0.58    0.58  16384    56.66    0.58    0.58      0
       65536         16384     float     sum      -1    63.39    1.03    1.03  32768    63.30    1.04    1.04      0
      131072         32768     float     sum      -1    79.38    1.65    1.65  65536    79.49    1.65    1.65      0
      262144         65536     float     sum      -1    111.5    2.35    2.35  131072    111.5    2.35    2.35      0
      524288        131072     float     sum      -1    174.6    3.00    3.00  262144    174.8    3.00    3.00      0
     1048576        262144     float     sum      -1    236.3    4.44    4.44  524288    235.8    4.45    4.45      0
     2097152        524288     float     sum      -1    350.3    5.99    5.99  1.04858e+06    349.4    6.00    6.00      0
     4194304       1048576     float     sum      -1    572.9    7.32    7.32  2.09715e+06    573.5    7.31    7.31      0
     8388608       2097152     float     sum      -1   1020.0    8.22    8.22  4.1943e+06   1020.0    8.22    8.22      0
    16777216       4194304     float     sum      -1   1944.2    8.63    8.63  8.38861e+06   1915.0    8.76    8.76      0
    33554432       8388608     float     sum      -1   3712.8    9.04    9.04  1.67772e+07   3710.9    9.04    9.04      0
    67108864      16777216     float     sum      -1   7279.9    9.22    9.22  3.35544e+07   7279.6    9.22    9.22      0
   134217728      33554432     float     sum      -1    14410    9.31    9.31  6.71088e+07    14414    9.31    9.31      0
   268435456      67108864     float     sum      -1    28658    9.37    9.37  1.34218e+08    28661    9.37    9.37      0
   536870912     134217728     float     sum      -1    57024    9.41    9.41  2.68435e+08    57033    9.41    9.41      0
x3212c0s13b0n0:29160:29160 [0] NCCL INFO comm 0x14adf045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:62867:62867 [0] NCCL INFO comm 0x14cf7645a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 4.51706 
#

NCCL TEST with MSCCL 1 channel 4gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29265 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29266 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  62968 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  62969 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29265:29265 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29265:29265 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29265:29265 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29266:29266 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29266:29266 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29266:29266 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62968:62968 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62969:62969 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62968:62968 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:62969:62969 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:62968:62968 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:62969:62969 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29265:29283 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29265:29283 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b0n0:29266:29284 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29266:29284 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:62968:62985 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62968:62985 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:62969:62986 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62969:62986 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29265:29283 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29265:29283 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29266:29284 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29266:29284 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29266:29284 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29266:29284 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:29266:29284 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29266:29284 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29266:29284 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29266:29284 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29265:29283 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29265:29283 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:29265:29283 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29265:29283 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29265:29283 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29265:29283 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:62968:62985 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62968:62985 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:62969:62986 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62969:62986 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62968:62985 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62968:62985 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:62968:62985 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62968:62985 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62968:62985 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62968:62985 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:62969:62986 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:62969:62986 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:62969:62986 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:62969:62986 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:62969:62986 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:62969:62986 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29265:29283 [0] NCCL INFO comm 0x14e77a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29266:29284 [1] NCCL INFO comm 0x148f0c45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29265:29265 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:62968:62985 [0] NCCL INFO comm 0x15029845a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:62969:62986 [1] NCCL INFO comm 0x147bc645a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
        1024           256     float     sum      -1    52.91    0.02    0.03   1024    53.06    0.02    0.03      0
        2048           512     float     sum      -1    58.15    0.04    0.05   2048    58.06    0.04    0.05      0
        4096          1024     float     sum      -1    55.38    0.07    0.11   4096    55.42    0.07    0.11      0
        8192          2048     float     sum      -1    57.34    0.14    0.21   8192    57.28    0.14    0.21      0
       16384          4096     float     sum      -1    67.69    0.24    0.36  16384    68.02    0.24    0.36      0
       32768          8192     float     sum      -1    92.31    0.35    0.53  32768    92.58    0.35    0.53      0
       65536         16384     float     sum      -1    130.3    0.50    0.75  65536    130.2    0.50    0.75      0
      131072         32768     float     sum      -1    206.1    0.64    0.95  131072    206.8    0.63    0.95      0
      262144         65536     float     sum      -1    358.4    0.73    1.10  262144    359.3    0.73    1.09      0
      524288        131072     float     sum      -1    663.1    0.79    1.19  524288    665.9    0.79    1.18      0
     1048576        262144     float     sum      -1    844.7    1.24    1.86  1.04858e+06    843.3    1.24    1.87      0
     2097152        524288     float     sum      -1   1201.4    1.75    2.62  2.09715e+06   1202.2    1.74    2.62      0
     4194304       1048576     float     sum      -1   1910.8    2.20    3.29  4.1943e+06   1911.5    2.19    3.29      0
     8388608       2097152     float     sum      -1   3327.5    2.52    3.78  8.38861e+06   3328.2    2.52    3.78      0
    16777216       4194304     float     sum      -1   6156.9    2.72    4.09  1.67772e+07   6150.2    2.73    4.09      0
    33554432       8388608     float     sum      -1    11789    2.85    4.27  3.35544e+07    11789    2.85    4.27      0
    67108864      16777216     float     sum      -1    23069    2.91    4.36  6.71088e+07    23070    2.91    4.36      0
   134217728      33554432     float     sum      -1    45628    2.94    4.41  1.34218e+08    45630    2.94    4.41      0
   268435456      67108864     float     sum      -1    90748    2.96    4.44  2.68435e+08    90744    2.96    4.44      0
   536870912     134217728     float     sum      -1   180988    2.97    4.45  5.36871e+08   180988    2.97    4.45      0
x3212c0s13b0n0:29266:29266 [1] NCCL INFO comm 0x148f0c45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:62969:62969 [1] NCCL INFO comm 0x147bc645a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:62968:62968 [0] NCCL INFO comm 0x15029845a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29265:29265 [0] NCCL INFO comm 0x14e77a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 2.14316 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29436 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29437 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63135 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63136 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29436:29436 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29436:29436 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29436:29436 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29437:29437 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29437:29437 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29437:29437 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63136:63136 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63136:63136 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63135:63135 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63135:63135 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63136:63136 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63135:63135 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29437:29455 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29437:29455 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:63135:63154 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63135:63154 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63136:63153 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63136:63153 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b0n0:29436:29454 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29436:29454 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29436:29454 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29436:29454 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29437:29455 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29437:29455 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29436:29454 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29436:29454 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:29436:29454 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29436:29454 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29437:29455 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29437:29455 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:29437:29455 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29437:29455 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29437:29455 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29437:29455 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29436:29454 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29436:29454 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63135:63154 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63135:63154 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63136:63153 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63136:63153 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63135:63154 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63135:63154 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:63135:63154 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63135:63154 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63135:63154 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63135:63154 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63136:63153 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63136:63153 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:63136:63153 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63136:63153 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63136:63153 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63136:63153 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63135:63154 [0] NCCL INFO comm 0x14608c259010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63136:63153 [1] NCCL INFO comm 0x14adf045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29436:29454 [0] NCCL INFO comm 0x148d7045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29437:29455 [1] NCCL INFO comm 0x15190c1dd010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29436:29436 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    55.92    0.02    0.03   1024    55.87    0.02    0.03      0
        2048           512     float     sum      -1    56.42    0.04    0.05   2048    56.33    0.04    0.05      0
        4096          1024     float     sum      -1    58.18    0.07    0.11   4096    58.33    0.07    0.11      0
        8192          2048     float     sum      -1    60.13    0.14    0.20   8192    60.30    0.14    0.20      0
       16384          4096     float     sum      -1    63.87    0.26    0.38  16384    63.89    0.26    0.38      0
       32768          8192     float     sum      -1    80.98    0.40    0.61  32768    80.91    0.40    0.61      0
       65536         16384     float     sum      -1    103.0    0.64    0.95  65536    103.1    0.64    0.95      0
      131072         32768     float     sum      -1    146.2    0.90    1.34  131072    145.3    0.90    1.35      0
      262144         65536     float     sum      -1    230.6    1.14    1.71  262144    231.5    1.13    1.70      0
      524288        131072     float     sum      -1    402.1    1.30    1.96  524288    403.6    1.30    1.95      0
     1048576        262144     float     sum      -1    504.5    2.08    3.12  1.04858e+06    504.4    2.08    3.12      0
     2097152        524288     float     sum      -1    713.8    2.94    4.41  2.09715e+06    713.0    2.94    4.41      0
     4194304       1048576     float     sum      -1   1128.3    3.72    5.58  4.1943e+06   1127.6    3.72    5.58      0
     8388608       2097152     float     sum      -1   1947.4    4.31    6.46  8.38861e+06   1946.3    4.31    6.47      0
    16777216       4194304     float     sum      -1   3588.9    4.67    7.01  1.67772e+07   3567.3    4.70    7.05      0
    33554432       8388608     float     sum      -1   6806.7    4.93    7.39  3.35544e+07   6805.4    4.93    7.40      0
    67108864      16777216     float     sum      -1    13285    5.05    7.58  6.71088e+07    13283    5.05    7.58      0
   134217728      33554432     float     sum      -1    26237    5.12    7.67  1.34218e+08    26236    5.12    7.67      0
   268435456      67108864     float     sum      -1    52144    5.15    7.72  2.68435e+08    52133    5.15    7.72      0
   536870912     134217728     float     sum      -1   103941    5.17    7.75  5.36871e+08   103954    5.16    7.75      0
x3212c0s13b0n0:29437:29437 [1] NCCL INFO comm 0x15190c1dd010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63136:63136 [1] NCCL INFO comm 0x14adf045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63135:63135 [0] NCCL INFO comm 0x14608c259010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29436:29436 [0] NCCL INFO comm 0x148d7045a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 3.60294 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29534 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29535 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63230 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63231 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29534:29534 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29534:29534 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29534:29534 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29535:29535 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29535:29535 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29535:29535 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63231:63231 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63230:63230 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63231:63231 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63230:63230 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63231:63231 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63230:63230 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29534:29553 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29534:29553 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b0n0:29535:29554 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29535:29554 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:63231:63248 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63231:63248 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b1n0:63230:63249 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63230:63249 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63230:63249 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63230:63249 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63231:63248 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63231:63248 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63230:63249 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63230:63249 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:63230:63249 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63230:63249 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63230:63249 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63230:63249 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63231:63248 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63231:63248 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:63231:63248 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63231:63248 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63231:63248 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63231:63248 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29534:29553 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29534:29553 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29535:29554 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29535:29554 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29535:29554 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29535:29554 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:29535:29554 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29535:29554 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29535:29554 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29535:29554 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29534:29553 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29534:29553 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:29534:29553 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29534:29553 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29534:29553 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29534:29553 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63230:63249 [0] NCCL INFO comm 0x15463045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63231:63248 [1] NCCL INFO comm 0x154191002010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29535:29554 [1] NCCL INFO comm 0x14f5c08a5010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29534:29553 [0] NCCL INFO comm 0x1531fa45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29534:29534 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    53.56    0.02    0.03   1024    53.18    0.02    0.03      0
        2048           512     float     sum      -1    55.12    0.04    0.06   2048    54.83    0.04    0.06      0
        4096          1024     float     sum      -1    55.06    0.07    0.11   4096    54.60    0.08    0.11      0
        8192          2048     float     sum      -1    56.88    0.14    0.22   8192    57.11    0.14    0.22      0
       16384          4096     float     sum      -1    60.66    0.27    0.41  16384    60.95    0.27    0.40      0
       32768          8192     float     sum      -1    72.03    0.45    0.68  32768    71.65    0.46    0.69      0
       65536         16384     float     sum      -1    86.56    0.76    1.14  65536    86.86    0.75    1.13      0
      131072         32768     float     sum      -1    114.5    1.14    1.72  131072    114.2    1.15    1.72      0
      262144         65536     float     sum      -1    169.4    1.55    2.32  262144    169.3    1.55    2.32      0
      524288        131072     float     sum      -1    279.2    1.88    2.82  524288    279.4    1.88    2.81      0
     1048576        262144     float     sum      -1    344.3    3.05    4.57  1.04858e+06    344.0    3.05    4.57      0
     2097152        524288     float     sum      -1    477.4    4.39    6.59  2.09715e+06    477.0    4.40    6.60      0
     4194304       1048576     float     sum      -1    750.8    5.59    8.38  4.1943e+06    749.7    5.59    8.39      0
     8388608       2097152     float     sum      -1   1305.7    6.42    9.64  8.38861e+06   1306.1    6.42    9.63      0
    16777216       4194304     float     sum      -1   2411.3    6.96   10.44  1.67772e+07   2386.1    7.03   10.55      0
    33554432       8388608     float     sum      -1   4520.7    7.42   11.13  3.35544e+07   4521.2    7.42   11.13      0
    67108864      16777216     float     sum      -1   8790.6    7.63   11.45  6.71088e+07   8789.8    7.63   11.45      0
   134217728      33554432     float     sum      -1    17337    7.74   11.61  1.34218e+08    17329    7.75   11.62      0
   268435456      67108864     float     sum      -1    34415    7.80   11.70  2.68435e+08    34418    7.80   11.70      0
   536870912     134217728     float     sum      -1    68579    7.83   11.74  5.36871e+08    68546    7.83   11.75      0
x3212c0s13b0n0:29535:29535 [1] NCCL INFO comm 0x14f5c08a5010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63231:63231 [1] NCCL INFO comm 0x154191002010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63230:63230 [0] NCCL INFO comm 0x15463045a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29534:29534 [0] NCCL INFO comm 0x1531fa45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 5.34061 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29566 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29567 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63258 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63259 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29566:29566 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29566:29566 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29566:29566 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29567:29567 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29567:29567 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29567:29567 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63259:63259 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63259:63259 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63258:63258 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63258:63258 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63259:63259 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63258:63258 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29567:29585 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29567:29585 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:29566:29584 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29566:29584 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b1n0:63258:63277 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63258:63277 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63259:63276 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63259:63276 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63258:63277 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63258:63277 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63259:63276 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63259:63276 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63258:63277 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63258:63277 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:63258:63277 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63258:63277 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63258:63277 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63258:63277 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63259:63276 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63259:63276 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:63259:63276 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63259:63276 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:63259:63276 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63259:63276 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29566:29584 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29566:29584 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29567:29585 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29567:29585 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29566:29584 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29566:29584 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:29566:29584 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29566:29584 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29566:29584 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29566:29584 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29567:29585 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29567:29585 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:29567:29585 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29567:29585 [1] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:29567:29585 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29567:29585 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63258:63277 [0] NCCL INFO comm 0x14b22c45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63259:63276 [1] NCCL INFO comm 0x1536b04d5010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29567:29585 [1] NCCL INFO comm 0x154b2045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29566:29584 [0] NCCL INFO comm 0x1495e0dd4010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29566:29566 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    59.35    0.02    0.03   1024    59.36    0.02    0.03      0
        2048           512     float     sum      -1    60.37    0.03    0.05   2048    61.02    0.03    0.05      0
        4096          1024     float     sum      -1    60.35    0.07    0.10   4096    60.44    0.07    0.10      0
        8192          2048     float     sum      -1    62.36    0.13    0.20   8192    62.77    0.13    0.20      0
       16384          4096     float     sum      -1    65.81    0.25    0.37  16384    65.70    0.25    0.37      0
       32768          8192     float     sum      -1    77.16    0.42    0.64  32768    77.54    0.42    0.63      0
       65536         16384     float     sum      -1    87.81    0.75    1.12  65536    87.57    0.75    1.12      0
      131072         32768     float     sum      -1    111.7    1.17    1.76  131072    111.7    1.17    1.76      0
      262144         65536     float     sum      -1    157.5    1.66    2.50  262144    158.1    1.66    2.49      0
      524288        131072     float     sum      -1    250.4    2.09    3.14  524288    250.3    2.09    3.14      0
     1048576        262144     float     sum      -1    298.2    3.52    5.27  1.04858e+06    298.4    3.51    5.27      0
     2097152        524288     float     sum      -1    403.4    5.20    7.80  2.09715e+06    404.7    5.18    7.77      0
     4194304       1048576     float     sum      -1    628.2    6.68   10.01  4.1943e+06    628.3    6.68   10.01      0
     8388608       2097152     float     sum      -1   1060.5    7.91   11.87  8.38861e+06   1061.9    7.90   11.85      0
    16777216       4194304     float     sum      -1   1985.3    8.45   12.68  1.67772e+07   1954.3    8.58   12.88      0
    33554432       8388608     float     sum      -1   3826.7    8.77   13.15  3.35544e+07   3807.7    8.81   13.22      0
    67108864      16777216     float     sum      -1   7530.6    8.91   13.37  6.71088e+07   7541.0    8.90   13.35      0
   134217728      33554432     float     sum      -1    15067    8.91   13.36  1.34218e+08    15078    8.90   13.35      0
   268435456      67108864     float     sum      -1    30112    8.91   13.37  2.68435e+08    30121    8.91   13.37      0
   536870912     134217728     float     sum      -1    60153    8.93   13.39  5.36871e+08    60163    8.92   13.39      0
x3212c0s13b0n0:29567:29567 [1] NCCL INFO comm 0x154b2045a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63259:63259 [1] NCCL INFO comm 0x1536b04d5010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b0n0:29566:29566 [0] NCCL INFO comm 0x1495e0dd4010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:63258:63258 [0] NCCL INFO comm 0x14b22c45a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 6.21306 
#

NCCL TEST with NCCL_MSCCL 1 channel 4gpus
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29667 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29668 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63356 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63357 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29667:29667 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29667:29667 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29667:29667 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29668:29668 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29668:29668 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29668:29668 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63356:63356 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63357:63357 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63356:63356 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63357:63357 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63357:63357 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63356:63356 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29668:29686 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29668:29686 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:29667:29685 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29667:29685 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b1n0:63356:63375 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63356:63375 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63357:63374 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63357:63374 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63356:63375 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63356:63375 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63357:63374 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63357:63374 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63356:63375 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63356:63375 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:63356:63375 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63356:63375 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63356:63375 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63356:63375 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63357:63374 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63357:63374 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b1n0:63357:63374 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63357:63374 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63357:63374 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63357:63374 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29667:29685 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29667:29685 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29668:29686 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29668:29686 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29667:29685 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29667:29685 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:29667:29685 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29667:29685 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29667:29685 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29667:29685 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29668:29686 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29668:29686 [1] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3212c0s13b0n0:29668:29686 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29668:29686 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29668:29686 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29668:29686 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29667:29685 [0] NCCL INFO comm 0x15256a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29668:29686 [1] NCCL INFO comm 0x14e6bc45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29667:29667 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:63356:63375 [0] NCCL INFO comm 0x149c5845a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63357:63374 [1] NCCL INFO comm 0x14d34045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
        1024           256     float     sum      -1    52.85    0.02    0.03   1024    53.07    0.02    0.03      0
        2048           512     float     sum      -1    58.32    0.04    0.05   2048    58.30    0.04    0.05      0
        4096          1024     float     sum      -1    55.27    0.07    0.11   4096    55.53    0.07    0.11      0
        8192          2048     float     sum      -1    57.63    0.14    0.21   8192    57.51    0.14    0.21      0
       16384          4096     float     sum      -1    67.92    0.24    0.36  16384    67.91    0.24    0.36      0
       32768          8192     float     sum      -1    92.46    0.35    0.53  32768    92.98    0.35    0.53      0
       65536         16384     float     sum      -1    130.8    0.50    0.75  65536    130.5    0.50    0.75      0
      131072         32768     float     sum      -1    206.7    0.63    0.95  131072    206.4    0.64    0.95      0
      262144         65536     float     sum      -1    358.3    0.73    1.10  262144    359.2    0.73    1.09      0
      524288        131072     float     sum      -1    663.6    0.79    1.19  524288    666.9    0.79    1.18      0
     1048576        262144     float     sum      -1    844.0    1.24    1.86  1.04858e+06    844.2    1.24    1.86      0
     2097152        524288     float     sum      -1   1203.8    1.74    2.61  2.09715e+06   1204.6    1.74    2.61      0
     4194304       1048576     float     sum      -1   1914.7    2.19    3.29  4.1943e+06   1915.7    2.19    3.28      0
     8388608       2097152     float     sum      -1   3336.7    2.51    3.77  8.38861e+06   3337.2    2.51    3.77      0
    16777216       4194304     float     sum      -1   6181.0    2.71    4.07  1.67772e+07   6170.2    2.72    4.08      0
    33554432       8388608     float     sum      -1    11834    2.84    4.25  3.35544e+07    11834    2.84    4.25      0
    67108864      16777216     float     sum      -1    23163    2.90    4.35  6.71088e+07    23164    2.90    4.35      0
   134217728      33554432     float     sum      -1    45817    2.93    4.39  1.34218e+08    45816    2.93    4.39      0
   268435456      67108864     float     sum      -1    91118    2.95    4.42  2.68435e+08    91119    2.95    4.42      0
   536870912     134217728     float     sum      -1   181739    2.95    4.43  5.36871e+08   181731    2.95    4.43      0
x3212c0s13b0n0:29668:29668 [1] NCCL INFO comm 0x14e6bc45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63357:63357 [1] NCCL INFO comm 0x14d34045a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63356:63356 [0] NCCL INFO comm 0x149c5845a010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29667:29667 [0] NCCL INFO comm 0x15256a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 2.13651 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29843 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29844 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63528 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63529 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29843:29843 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29843:29843 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29843:29843 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29844:29844 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29844:29844 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29844:29844 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63529:63529 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63528:63528 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63529:63529 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63528:63528 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63529:63529 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63528:63528 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29843:29862 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29843:29862 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b0n0:29844:29863 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29844:29863 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:63529:63546 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63529:63546 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b1n0:63528:63547 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63528:63547 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63528:63547 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63528:63547 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63529:63546 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63529:63546 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63528:63547 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63528:63547 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:63528:63547 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63528:63547 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63528:63547 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63528:63547 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63529:63546 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63529:63546 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:63529:63546 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63529:63546 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63529:63546 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63529:63546 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29843:29862 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29843:29862 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29843:29862 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29843:29862 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:29843:29862 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29843:29862 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29843:29862 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29843:29862 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29844:29863 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29844:29863 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29844:29863 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29844:29863 [1] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:29844:29863 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29844:29863 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29844:29863 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29844:29863 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29843:29862 [0] NCCL INFO comm 0x15353a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29844:29863 [1] NCCL INFO comm 0x15292075e010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29843:29843 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:63528:63547 [0] NCCL INFO comm 0x152540eb4010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63529:63546 [1] NCCL INFO comm 0x1503007e8010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
        1024           256     float     sum      -1    55.86    0.02    0.03   1024    55.55    0.02    0.03      0
        2048           512     float     sum      -1    56.58    0.04    0.05   2048    58.10    0.04    0.05      0
        4096          1024     float     sum      -1    58.05    0.07    0.11   4096    58.55    0.07    0.10      0
        8192          2048     float     sum      -1    60.39    0.14    0.20   8192    60.56    0.14    0.20      0
       16384          4096     float     sum      -1    63.83    0.26    0.39  16384    64.04    0.26    0.38      0
       32768          8192     float     sum      -1    80.87    0.41    0.61  32768    80.84    0.41    0.61      0
       65536         16384     float     sum      -1    102.5    0.64    0.96  65536    102.9    0.64    0.96      0
      131072         32768     float     sum      -1    145.4    0.90    1.35  131072    145.6    0.90    1.35      0
      262144         65536     float     sum      -1    230.2    1.14    1.71  262144    231.3    1.13    1.70      0
      524288        131072     float     sum      -1    401.6    1.31    1.96  524288    403.1    1.30    1.95      0
     1048576        262144     float     sum      -1    504.0    2.08    3.12  1.04858e+06    504.0    2.08    3.12      0
     2097152        524288     float     sum      -1    713.2    2.94    4.41  2.09715e+06    714.5    2.94    4.40      0
     4194304       1048576     float     sum      -1   1129.0    3.72    5.57  4.1943e+06   1128.7    3.72    5.57      0
     8388608       2097152     float     sum      -1   1947.4    4.31    6.46  8.38861e+06   1947.9    4.31    6.46      0
    16777216       4194304     float     sum      -1   3586.9    4.68    7.02  1.67772e+07   3570.8    4.70    7.05      0
    33554432       8388608     float     sum      -1   6811.5    4.93    7.39  3.35544e+07   6809.0    4.93    7.39      0
    67108864      16777216     float     sum      -1    13290    5.05    7.57  6.71088e+07    13290    5.05    7.57      0
   134217728      33554432     float     sum      -1    26243    5.11    7.67  1.34218e+08    26245    5.11    7.67      0
   268435456      67108864     float     sum      -1    52151    5.15    7.72  2.68435e+08    52148    5.15    7.72      0
   536870912     134217728     float     sum      -1   103960    5.16    7.75  5.36871e+08   103994    5.16    7.74      0
x3212c0s13b0n0:29844:29844 [1] NCCL INFO comm 0x15292075e010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63529:63529 [1] NCCL INFO comm 0x1503007e8010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63528:63528 [0] NCCL INFO comm 0x152540eb4010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29843:29843 [0] NCCL INFO comm 0x15353a45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 3.60227 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29941 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29942 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63622 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63623 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29941:29941 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29941:29941 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29941:29941 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29942:29942 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29942:29942 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29942:29942 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63623:63623 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63622:63622 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63623:63623 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63622:63622 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63623:63623 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63622:63622 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29941:29959 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29941:29959 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b0n0:29942:29960 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29942:29960 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b1n0:63622:63641 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63622:63641 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63623:63640 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63623:63640 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63622:63641 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63622:63641 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63623:63640 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63623:63640 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63622:63641 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63622:63641 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:63622:63641 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63622:63641 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63622:63641 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63622:63641 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63623:63640 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63623:63640 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b1n0:63623:63640 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63623:63640 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63623:63640 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63623:63640 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29941:29959 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29941:29959 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29942:29960 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29942:29960 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29941:29959 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29941:29959 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:29941:29959 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29941:29959 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29941:29959 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29941:29959 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29942:29960 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29942:29960 [1] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3212c0s13b0n0:29942:29960 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29942:29960 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29942:29960 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29942:29960 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29941:29959 [0] NCCL INFO comm 0x15490645a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:29942:29960 [1] NCCL INFO comm 0x14922a45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29941:29941 [0] NCCL INFO Launch mode Parallel
x3212c0s13b1n0:63623:63640 [1] NCCL INFO comm 0x1505d00ea010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b1n0:63622:63641 [0] NCCL INFO comm 0x147e79610010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    53.87    0.02    0.03   1024    53.77    0.02    0.03      0
        2048           512     float     sum      -1    55.31    0.04    0.06   2048    54.83    0.04    0.06      0
        4096          1024     float     sum      -1    55.14    0.07    0.11   4096    55.57    0.07    0.11      0
        8192          2048     float     sum      -1    56.95    0.14    0.22   8192    56.98    0.14    0.22      0
       16384          4096     float     sum      -1    61.25    0.27    0.40  16384    61.00    0.27    0.40      0
       32768          8192     float     sum      -1    72.13    0.45    0.68  32768    72.08    0.45    0.68      0
       65536         16384     float     sum      -1    86.82    0.75    1.13  65536    86.85    0.75    1.13      0
      131072         32768     float     sum      -1    114.6    1.14    1.72  131072    114.9    1.14    1.71      0
      262144         65536     float     sum      -1    169.5    1.55    2.32  262144    169.8    1.54    2.32      0
      524288        131072     float     sum      -1    279.7    1.87    2.81  524288    279.8    1.87    2.81      0
     1048576        262144     float     sum      -1    345.0    3.04    4.56  1.04858e+06    344.6    3.04    4.56      0
     2097152        524288     float     sum      -1    479.5    4.37    6.56  2.09715e+06    479.8    4.37    6.56      0
     4194304       1048576     float     sum      -1    754.2    5.56    8.34  4.1943e+06    755.0    5.56    8.33      0
     8388608       2097152     float     sum      -1   1309.7    6.41    9.61  8.38861e+06   1308.6    6.41    9.62      0
    16777216       4194304     float     sum      -1   2413.5    6.95   10.43  1.67772e+07   2391.6    7.02   10.52      0
    33554432       8388608     float     sum      -1   4526.8    7.41   11.12  3.35544e+07   4529.3    7.41   11.11      0
    67108864      16777216     float     sum      -1   8804.0    7.62   11.43  6.71088e+07   8805.6    7.62   11.43      0
   134217728      33554432     float     sum      -1    17355    7.73   11.60  1.34218e+08    17357    7.73   11.60      0
   268435456      67108864     float     sum      -1    34452    7.79   11.69  2.68435e+08    34460    7.79   11.68      0
   536870912     134217728     float     sum      -1    68622    7.82   11.74  5.36871e+08    68643    7.82   11.73      0
x3212c0s13b1n0:63623:63623 [1] NCCL INFO comm 0x1505d00ea010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b0n0:29942:29942 [1] NCCL INFO comm 0x14922a45a010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63622:63622 [0] NCCL INFO comm 0x147e79610010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:29941:29941 [0] NCCL INFO comm 0x15490645a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 5.32904 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  29972 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  29973 on x3212c0s13b0n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
#  Rank  2 Group  0 Pid  63650 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  3 Group  0 Pid  63651 on x3212c0s13b1n0 device  1 [0x46] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29972:29972 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29972:29972 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29972:29972 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:29973:29973 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:29973:29973 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:29973:29973 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:63650:63650 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63651:63651 [1] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63651:63651 [1] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:63650:63650 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:63651:63651 [1] NCCL INFO Using network AWS Libfabric
x3212c0s13b1n0:63650:63650 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:29973:29992 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29973:29992 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Trees [0] -1/-1/-1->1->0
x3212c0s13b0n0:29972:29991 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29972:29991 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Channel 00/01 :    0   1   2   3
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Trees [0] 1/2/-1->0->-1
x3212c0s13b1n0:63650:63669 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63650:63669 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Trees [0] 3/-1/-1->2->0
x3212c0s13b1n0:63651:63668 [1] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63651:63668 [1] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 1.
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Trees [0] -1/-1/-1->3->2
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Channel 00 : 2[7000] -> 3[46000] via P2P/IPC/read
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Channel 00/0 : 3[46000] -> 0[7000] [receive] via NET/AWS Libfabric/3
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[7000] [send] via NET/AWS Libfabric/3
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Channel 00 : 0[7000] -> 1[46000] via P2P/IPC/read
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Connected all rings
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Channel 00 : 3[46000] -> 2[7000] via P2P/IPC/read
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Connected all rings
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Channel 00 : 1[46000] -> 0[7000] via P2P/IPC/read
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Channel 00/0 : 0[7000] -> 2[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Channel 00/0 : 2[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:63650:63669 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63650:63669 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Connected all trees
x3212c0s13b1n0:63651:63668 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63651:63668 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63650:63669 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63650:63669 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:63650:63669 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63650:63669 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63650:63669 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63650:63669 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b1n0:63651:63668 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:63651:63668 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b1n0:63651:63668 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:63651:63668 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:63651:63668 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:63651:63668 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:29972:29991 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29972:29991 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Connected all trees
x3212c0s13b0n0:29973:29992 [1] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29973:29992 [1] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_4gpus_channel1_reverse_chunk1.xml successfully.
x3212c0s13b0n0:29972:29991 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29972:29991 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:29972:29991 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29972:29991 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29973:29992 [1] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:29973:29992 [1] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3212c0s13b0n0:29973:29992 [1] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:29973:29992 [1] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:29973:29992 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29973:29992 [1] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b0n0:29972:29991 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:29972:29991 [0] NCCL INFO 1 coll channels, 1 p2p channels, 1 p2p channels per peer
x3212c0s13b1n0:63650:63669 [0] NCCL INFO comm 0x147ea08a5010 rank 2 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b1n0:63651:63668 [1] NCCL INFO comm 0x14e36a45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29972:29991 [0] NCCL INFO comm 0x14a81c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:29973:29992 [1] NCCL INFO comm 0x14ed05bef010 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3212c0s13b0n0:29972:29972 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    58.66    0.02    0.03   1024    58.80    0.02    0.03      0
        2048           512     float     sum      -1    60.40    0.03    0.05   2048    60.24    0.03    0.05      0
        4096          1024     float     sum      -1    60.05    0.07    0.10   4096    59.95    0.07    0.10      0
        8192          2048     float     sum      -1    61.99    0.13    0.20   8192    62.11    0.13    0.20      0
       16384          4096     float     sum      -1    65.55    0.25    0.37  16384    65.57    0.25    0.37      0
       32768          8192     float     sum      -1    77.61    0.42    0.63  32768    77.66    0.42    0.63      0
       65536         16384     float     sum      -1    87.81    0.75    1.12  65536    88.00    0.74    1.12      0
      131072         32768     float     sum      -1    111.7    1.17    1.76  131072    111.7    1.17    1.76      0
      262144         65536     float     sum      -1    157.5    1.66    2.50  262144    158.3    1.66    2.48      0
      524288        131072     float     sum      -1    252.2    2.08    3.12  524288    250.5    2.09    3.14      0
     1048576        262144     float     sum      -1    298.0    3.52    5.28  1.04858e+06    298.1    3.52    5.28      0
     2097152        524288     float     sum      -1    403.7    5.19    7.79  2.09715e+06    404.3    5.19    7.78      0
     4194304       1048576     float     sum      -1    625.8    6.70   10.05  4.1943e+06    624.1    6.72   10.08      0
     8388608       2097152     float     sum      -1   1054.9    7.95   11.93  8.38861e+06   1053.9    7.96   11.94      0
    16777216       4194304     float     sum      -1   1958.8    8.57   12.85  1.67772e+07   1963.0    8.55   12.82      0
    33554432       8388608     float     sum      -1   3829.0    8.76   13.14  3.35544e+07   3802.2    8.83   13.24      0
    67108864      16777216     float     sum      -1   7534.6    8.91   13.36  6.71088e+07   7543.6    8.90   13.34      0
   134217728      33554432     float     sum      -1    15049    8.92   13.38  1.34218e+08    15055    8.92   13.37      0
   268435456      67108864     float     sum      -1    30073    8.93   13.39  2.68435e+08    30078    8.92   13.39      0
   536870912     134217728     float     sum      -1    60075    8.94   13.40  5.36871e+08    60095    8.93   13.40      0
x3212c0s13b0n0:29973:29973 [1] NCCL INFO comm 0x14ed05bef010 rank 1 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b1n0:63651:63651 [1] NCCL INFO comm 0x14e36a45a010 rank 3 nranks 4 cudaDev 1 busId 46000 - Destroy COMPLETE
x3212c0s13b0n0:29972:29972 [0] NCCL INFO comm 0x14a81c45a010 rank 0 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b1n0:63650:63650 [0] NCCL INFO comm 0x147ea08a5010 rank 2 nranks 4 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 80 FAILED
# Avg bus bandwidth    : 6.22457 
#

