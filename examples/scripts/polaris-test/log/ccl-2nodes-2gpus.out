NCCL TEST with MSCCL
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  11312 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   8629 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:11312:11312 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:11312:11312 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:11312:11312 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:8629:8629 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:8629:8629 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:8629:8629 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:8629:8642 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b1n0:8629:8642 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml successfully.
x3212c0s13b1n0:8629:8642 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:8629:8642 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:8629:8642 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:8629:8642 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b1n0:8629:8642 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:8629:8642 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:11312:11326 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b0n0:11312:11326 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml successfully.
x3212c0s13b0n0:11312:11326 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:11312:11326 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:11312:11326 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:11312:11326 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3212c0s13b0n0:11312:11326 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:11312:11326 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:8629:8642 [0] NCCL INFO comm 0x14d57c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:11312:11326 [0] NCCL INFO comm 0x14665a45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b0n0:11312:11312 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    38.26    0.03    0.03    512    38.17    0.03    0.03      0
        2048           512     float     sum      -1    38.08    0.05    0.05   1024    38.27    0.05    0.05      0
        4096          1024     float     sum      -1    38.67    0.11    0.11   2048    38.84    0.11    0.11      0
        8192          2048     float     sum      -1    41.27    0.20    0.20   4096    41.09    0.20    0.20      0
       16384          4096     float     sum      -1    42.57    0.38    0.38   8192    42.64    0.38    0.38      0
       32768          8192     float     sum      -1    45.01    0.73    0.73  16384    44.99    0.73    0.73      0
       65536         16384     float     sum      -1    59.26    1.11    1.11  32768    59.39    1.10    1.10      0
      131072         32768     float     sum      -1    75.49    1.74    1.74  65536    75.45    1.74    1.74      0
      262144         65536     float     sum      -1    107.4    2.44    2.44  131072    107.0    2.45    2.45      0
      524288        131072     float     sum      -1    171.8    3.05    3.05  262144    171.0    3.07    3.07      0
     1048576        262144     float     sum      -1    299.3    3.50    3.50  524288    298.1    3.52    3.52      0
     2097152        524288     float     sum      -1    453.9    4.62    4.62  1.04858e+06    456.7    4.59    4.59      0
     4194304       1048576     float     sum      -1    780.9    5.37    5.37  2.09715e+06    779.9    5.38    5.38      0
     8388608       2097152     float     sum      -1   1417.8    5.92    5.92  4.1943e+06   1418.2    5.91    5.91      0
    16777216       4194304     float     sum      -1   2716.1    6.18    6.18  8.38861e+06   2722.5    6.16    6.16      0
    33554432       8388608     float     sum      -1   5294.0    6.34    6.34  1.67772e+07   5329.3    6.30    6.30      0
    67108864      16777216     float     sum      -1    10404    6.45    6.45  3.35544e+07    10410    6.45    6.45      0
   134217728      33554432     float     sum      -1    20662    6.50    6.50  6.71088e+07    20652    6.50    6.50      0
   268435456      67108864     float     sum      -1    41195    6.52    6.52  1.34218e+08    41167    6.52    6.52      0
   536870912     134217728     float     sum      -1    82289    6.52    6.52  2.68435e+08    82270    6.53    6.53      0
x3212c0s13b1n0:8629:8629 [0] NCCL INFO comm 0x14d57c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:11312:11312 [0] NCCL INFO comm 0x14665a45a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.38628 
#

NCCL TEST with NCCL_MSCCL
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  11349 on x3212c0s13b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid   8652 on x3212c0s13b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b0n0:11349:11349 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.144<0>
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b0n0:11349:11349 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b0n0:11349:11349 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3212c0s13b1n0:8652:8652 [0] NCCL INFO Bootstrap : Using hsn1:10.201.4.147<0>
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3212c0s13b1n0:8652:8652 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3212c0s13b1n0:8652:8652 [0] NCCL INFO Using network AWS Libfabric
x3212c0s13b0n0:11349:11431 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 2.
x3212c0s13b0n0:11349:11431 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 2.
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 00/02 :    0   1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 01/02 :    0   1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3212c0s13b1n0:8652:8738 [0] NCCL INFO NCCL_MAX_NCHANNELS set by environment to 2.
x3212c0s13b1n0:8652:8738 [0] NCCL INFO NCCL_MIN_NCHANNELS set by environment to 2.
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Connected all rings
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Connected all trees
x3212c0s13b0n0:11349:11431 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b0n0:11349:11431 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml successfully.
x3212c0s13b0n0:11349:11431 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b0n0:11349:11431 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b0n0:11349:11431 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b0n0:11349:11431 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b0n0:11349:11431 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b0n0:11349:11431 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Connected all rings
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Connected all trees
x3212c0s13b1n0:8652:8738 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b1n0:8652:8738 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_channel2_reverse_chunk2.xml successfully.
x3212c0s13b1n0:8652:8738 [0] NCCL INFO Connected 1 MSCCL algorithms
x3212c0s13b1n0:8652:8738 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3212c0s13b1n0:8652:8738 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3212c0s13b1n0:8652:8738 [0] NCCL INFO NCCL_ALGO set by environment to TREE
x3212c0s13b1n0:8652:8738 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3212c0s13b1n0:8652:8738 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3212c0s13b0n0:11349:11431 [0] NCCL INFO comm 0x1509e645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3212c0s13b1n0:8652:8738 [0] NCCL INFO comm 0x152e3c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3212c0s13b0n0:11349:11349 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    37.87    0.03    0.03    512    37.81    0.03    0.03      0
        2048           512     float     sum      -1    38.04    0.05    0.05   1024    38.13    0.05    0.05      0
        4096          1024     float     sum      -1    38.50    0.11    0.11   2048    38.70    0.11    0.11      0
        8192          2048     float     sum      -1    41.15    0.20    0.20   4096    40.89    0.20    0.20      0
       16384          4096     float     sum      -1    42.30    0.39    0.39   8192    42.26    0.39    0.39      0
       32768          8192     float     sum      -1    44.65    0.73    0.73  16384    44.62    0.73    0.73      0
       65536         16384     float     sum      -1    58.73    1.12    1.12  32768    58.68    1.12    1.12      0
      131072         32768     float     sum      -1    75.08    1.75    1.75  65536    75.03    1.75    1.75      0
      262144         65536     float     sum      -1    108.0    2.43    2.43  131072    107.2    2.44    2.44      0
      524288        131072     float     sum      -1    172.9    3.03    3.03  262144    172.6    3.04    3.04      0
     1048576        262144     float     sum      -1    302.3    3.47    3.47  524288    302.1    3.47    3.47      0
     2097152        524288     float     sum      -1    457.8    4.58    4.58  1.04858e+06    457.6    4.58    4.58      0
     4194304       1048576     float     sum      -1    787.3    5.33    5.33  2.09715e+06    786.1    5.34    5.34      0
     8388608       2097152     float     sum      -1   1434.5    5.85    5.85  4.1943e+06   1433.1    5.85    5.85      0
    16777216       4194304     float     sum      -1   2752.6    6.10    6.10  8.38861e+06   2749.0    6.10    6.10      0
    33554432       8388608     float     sum      -1   5328.9    6.30    6.30  1.67772e+07   5368.9    6.25    6.25      0
    67108864      16777216     float     sum      -1    10494    6.40    6.40  3.35544e+07    10481    6.40    6.40      0
   134217728      33554432     float     sum      -1    20814    6.45    6.45  6.71088e+07    20816    6.45    6.45      0
   268435456      67108864     float     sum      -1    41474    6.47    6.47  1.34218e+08    41476    6.47    6.47      0
   536870912     134217728     float     sum      -1    82837    6.48    6.48  2.68435e+08    82805    6.48    6.48      0
x3212c0s13b1n0:8652:8652 [0] NCCL INFO comm 0x152e3c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3212c0s13b0n0:11349:11349 [0] NCCL INFO comm 0x1509e645a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.36256 
#

