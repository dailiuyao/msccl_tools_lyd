NCCL TEST with MSCCL 1 channel 2gpus 128 steps
# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  23986 on x3005c0s7b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  27160 on x3005c0s7b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b0n0:23986:23986 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.211<0>
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b0n0:23986:23986 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b0n0:23986:23986 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b1n0:27160:27160 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.205<0>
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b1n0:27160:27160 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b1n0:27160:27160 [0] NCCL INFO Using network AWS Libfabric
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 00/02 :    0   1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 01/02 :    0   1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Connected all rings
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Connected all trees
x3005c0s7b0n0:23986:23999 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:23986:23999 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Connected all rings
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Connected all trees
x3005c0s7b1n0:27160:27173 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27160:27173 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b0n0:23986:23999 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b0n0:23986:23999 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3005c0s7b0n0:23986:23999 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b0n0:23986:23999 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b0n0:23986:23999 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b0n0:23986:23999 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b1n0:27160:27173 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b1n0:27160:27173 [0] NCCL INFO NCCL_NTHREADS set by environment to 64.
x3005c0s7b1n0:27160:27173 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b1n0:27160:27173 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b1n0:27160:27173 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b1n0:27160:27173 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b0n0:23986:23999 [0] NCCL INFO comm 0x14603d017010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3005c0s7b0n0:23986:23986 [0] NCCL INFO Launch mode Parallel
x3005c0s7b1n0:27160:27173 [0] NCCL INFO comm 0x154a9845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    515.1    0.00    0.00    512    516.1    0.00    0.00      0
        2048           512     float     sum      -1    509.3    0.00    0.00   1024    509.9    0.00    0.00      0
        4096          1024     float     sum      -1    512.1    0.01    0.01   2048    510.2    0.01    0.01      0
        8192          2048     float     sum      -1    510.2    0.02    0.02   4096    510.3    0.02    0.02      0
       16384          4096     float     sum      -1    513.9    0.03    0.03   8192    514.7    0.03    0.03      0
       32768          8192     float     sum      -1    561.3    0.06    0.06  16384    527.9    0.06    0.06      0
       65536         16384     float     sum      -1    550.9    0.12    0.12  32768    551.3    0.12    0.12      0
      131072         32768     float     sum      -1    613.3    0.21    0.21  65536    613.8    0.21    0.21      0
      262144         65536     float     sum      -1    790.4    0.33    0.33  131072    789.4    0.33    0.33      0
      524288        131072     float     sum      -1    939.2    0.56    0.56  262144    939.5    0.56    0.56      0
     1048576        262144     float     sum      -1   1017.9    1.03    1.03  524288   1017.1    1.03    1.03      0
     2097152        524288     float     sum      -1   1531.6    1.37    1.37  1.04858e+06   1532.4    1.37    1.37      0
     4194304       1048576     float     sum      -1   2609.9    1.61    1.61  2.09715e+06   2610.2    1.61    1.61      0
     8388608       2097152     float     sum      -1   4659.0    1.80    1.80  4.1943e+06   4658.9    1.80    1.80      0
    16777216       4194304     float     sum      -1   8780.1    1.91    1.91  8.38861e+06   8777.6    1.91    1.91      0
    33554432       8388608     float     sum      -1    17042    1.97    1.97  1.67772e+07    17041    1.97    1.97      0
    67108864      16777216     float     sum      -1    33458    2.01    2.01  3.35544e+07    33455    2.01    2.01      0
   134217728      33554432     float     sum      -1    66693    2.01    2.01  6.71088e+07    66686    2.01    2.01      0
   268435456      67108864     float     sum      -1   133192    2.02    2.02  1.34218e+08   133167    2.02    2.02      0
   536870912     134217728     float     sum      -1   266153    2.02    2.02  2.68435e+08   266131    2.02    2.02      0
x3005c0s7b0n0:23986:23986 [0] NCCL INFO comm 0x14603d017010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3005c0s7b1n0:27160:27160 [0] NCCL INFO comm 0x154a9845a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 0.95415 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  24233 on x3005c0s7b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  27409 on x3005c0s7b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b0n0:24233:24233 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.211<0>
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b0n0:24233:24233 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b0n0:24233:24233 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b1n0:27409:27409 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.205<0>
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b1n0:27409:27409 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b1n0:27409:27409 [0] NCCL INFO Using network AWS Libfabric
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 00/02 :    0   1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 01/02 :    0   1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Connected all rings
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Connected all trees
x3005c0s7b0n0:24233:24249 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24233:24249 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Connected all rings
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Connected all trees
x3005c0s7b1n0:27409:27422 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27409:27422 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b0n0:24233:24249 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b0n0:24233:24249 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3005c0s7b0n0:24233:24249 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b0n0:24233:24249 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b0n0:24233:24249 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b0n0:24233:24249 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b1n0:27409:27422 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b1n0:27409:27422 [0] NCCL INFO NCCL_NTHREADS set by environment to 128.
x3005c0s7b1n0:27409:27422 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b1n0:27409:27422 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b1n0:27409:27422 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b1n0:27409:27422 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b1n0:27409:27422 [0] NCCL INFO comm 0x14bdd0fd5010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
x3005c0s7b0n0:24233:24249 [0] NCCL INFO comm 0x154ebd272010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3005c0s7b0n0:24233:24233 [0] NCCL INFO Launch mode Parallel
        1024           256     float     sum      -1    690.9    0.00    0.00    512    693.5    0.00    0.00      0
        2048           512     float     sum      -1    678.6    0.00    0.00   1024    680.8    0.00    0.00      0
        4096          1024     float     sum      -1    681.8    0.01    0.01   2048    679.8    0.01    0.01      0
        8192          2048     float     sum      -1    681.2    0.01    0.01   4096    681.0    0.01    0.01      0
       16384          4096     float     sum      -1    686.1    0.02    0.02   8192    716.0    0.02    0.02      0
       32768          8192     float     sum      -1    690.9    0.05    0.05  16384    690.6    0.05    0.05      0
       65536         16384     float     sum      -1    701.0    0.09    0.09  32768    702.2    0.09    0.09      0
      131072         32768     float     sum      -1    749.8    0.17    0.17  65536    748.8    0.18    0.18      0
      262144         65536     float     sum      -1    802.9    0.33    0.33  131072    804.1    0.33    0.33      0
      524288        131072     float     sum      -1   1010.6    0.52    0.52  262144   1011.8    0.52    0.52      0
     1048576        262144     float     sum      -1   1050.5    1.00    1.00  524288   1050.3    1.00    1.00      0
     2097152        524288     float     sum      -1   1129.4    1.86    1.86  1.04858e+06   1128.4    1.86    1.86      0
     4194304       1048576     float     sum      -1   1669.5    2.51    2.51  2.09715e+06   1671.1    2.51    2.51      0
     8388608       2097152     float     sum      -1   2744.2    3.06    3.06  4.1943e+06   2743.8    3.06    3.06      0
    16777216       4194304     float     sum      -1   4880.0    3.44    3.44  8.38861e+06   4879.7    3.44    3.44      0
    33554432       8388608     float     sum      -1   9147.4    3.67    3.67  1.67772e+07   9147.5    3.67    3.67      0
    67108864      16777216     float     sum      -1    17661    3.80    3.80  3.35544e+07    17659    3.80    3.80      0
   134217728      33554432     float     sum      -1    35184    3.81    3.81  6.71088e+07    35179    3.82    3.82      0
   268435456      67108864     float     sum      -1    70241    3.82    3.82  1.34218e+08    70247    3.82    3.82      0
   536870912     134217728     float     sum      -1   140381    3.82    3.82  2.68435e+08   140395    3.82    3.82      0
x3005c0s7b0n0:24233:24233 [0] NCCL INFO comm 0x154ebd272010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3005c0s7b1n0:27409:27409 [0] NCCL INFO comm 0x14bdd0fd5010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 1.59987 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  24339 on x3005c0s7b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  27509 on x3005c0s7b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b0n0:24339:24339 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.211<0>
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b0n0:24339:24339 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b0n0:24339:24339 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b1n0:27509:27509 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.205<0>
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b1n0:27509:27509 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b1n0:27509:27509 [0] NCCL INFO Using network AWS Libfabric
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 00/02 :    0   1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 01/02 :    0   1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Connected all rings
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Connected all trees
x3005c0s7b0n0:24339:24355 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24339:24355 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b0n0:24339:24355 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b0n0:24339:24355 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3005c0s7b0n0:24339:24355 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b0n0:24339:24355 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b0n0:24339:24355 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b0n0:24339:24355 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Connected all rings
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Connected all trees
x3005c0s7b1n0:27509:27524 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27509:27524 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b1n0:27509:27524 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b1n0:27509:27524 [0] NCCL INFO NCCL_NTHREADS set by environment to 256.
x3005c0s7b1n0:27509:27524 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b1n0:27509:27524 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b1n0:27509:27524 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b1n0:27509:27524 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b0n0:24339:24355 [0] NCCL INFO comm 0x14931045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3005c0s7b0n0:24339:24339 [0] NCCL INFO Launch mode Parallel
x3005c0s7b1n0:27509:27524 [0] NCCL INFO comm 0x14e51c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    531.3    0.00    0.00    512    534.1    0.00    0.00      0
        2048           512     float     sum      -1    522.8    0.00    0.00   1024    522.2    0.00    0.00      0
        4096          1024     float     sum      -1    525.0    0.01    0.01   2048    522.4    0.01    0.01      0
        8192          2048     float     sum      -1    522.7    0.02    0.02   4096    523.0    0.02    0.02      0
       16384          4096     float     sum      -1    525.0    0.03    0.03   8192    525.3    0.03    0.03      0
       32768          8192     float     sum      -1    558.3    0.06    0.06  16384    526.9    0.06    0.06      0
       65536         16384     float     sum      -1    525.3    0.12    0.12  32768    525.5    0.12    0.12      0
      131072         32768     float     sum      -1    527.8    0.25    0.25  65536    527.6    0.25    0.25      0
      262144         65536     float     sum      -1    533.4    0.49    0.49  131072    534.7    0.49    0.49      0
      524288        131072     float     sum      -1    800.9    0.65    0.65  262144    801.0    0.65    0.65      0
     1048576        262144     float     sum      -1    820.6    1.28    1.28  524288    821.0    1.28    1.28      0
     2097152        524288     float     sum      -1    912.9    2.30    2.30  1.04858e+06    912.9    2.30    2.30      0
     4194304       1048576     float     sum      -1   1138.5    3.68    3.68  2.09715e+06   1132.6    3.70    3.70      0
     8388608       2097152     float     sum      -1   1806.7    4.64    4.64  4.1943e+06   1801.2    4.66    4.66      0
    16777216       4194304     float     sum      -1   3038.6    5.52    5.52  8.38861e+06   3038.6    5.52    5.52      0
    33554432       8388608     float     sum      -1   5457.0    6.15    6.15  1.67772e+07   5454.6    6.15    6.15      0
    67108864      16777216     float     sum      -1    10218    6.57    6.57  3.35544e+07    10212    6.57    6.57      0
   134217728      33554432     float     sum      -1    20326    6.60    6.60  6.71088e+07    20336    6.60    6.60      0
   268435456      67108864     float     sum      -1    40611    6.61    6.61  1.34218e+08    40570    6.62    6.62      0
   536870912     134217728     float     sum      -1    81077    6.62    6.62  2.68435e+08    81063    6.62    6.62      0
x3005c0s7b0n0:24339:24339 [0] NCCL INFO comm 0x14931045a010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3005c0s7b1n0:27509:27509 [0] NCCL INFO comm 0x14e51c45a010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 2.58183 
#

# nThread 1 nGpus 1 minBytes 1024 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 60 agg iters: 1 validation: 1 graph: 0
#
# Using devices
#  Rank  0 Group  0 Pid  24448 on x3005c0s7b0n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
#  Rank  1 Group  0 Pid  27613 on x3005c0s7b1n0 device  0 [0x07] NVIDIA A100-SXM4-40GB
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b0n0:24448:24448 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.211<0>
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b0n0:24448:24448 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b0n0:24448:24448 [0] NCCL INFO Using network AWS Libfabric
NCCL version 2.12.12.MSCCL.0.7.4+cuda11.8
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to hsn0,hsn1
x3005c0s7b1n0:27613:27613 [0] NCCL INFO Bootstrap : Using hsn1:10.201.1.205<0>
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v5 symbol.
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v4 symbol.
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/OFI Initializing aws-ofi-nccl 1.7.4-aws
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/OFI Using CUDA runtime version 11080
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/OFI Selected Provider is cxi (found 4 nics)
x3005c0s7b1n0:27613:27613 [0] NCCL INFO NET/OFI Using transport protocol SENDRECV
x3005c0s7b1n0:27613:27613 [0] NCCL INFO Using network AWS Libfabric
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 00/02 :    0   1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 01/02 :    0   1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [receive] via NET/AWS Libfabric/1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Channel 00/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Channel 01/0 : 1[7000] -> 0[7000] [send] via NET/AWS Libfabric/1
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Connected all rings
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Connected all trees
x3005c0s7b0n0:24448:24460 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24448:24460 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b0n0:24448:24460 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b0n0:24448:24460 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3005c0s7b0n0:24448:24460 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b0n0:24448:24460 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b0n0:24448:24460 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b0n0:24448:24460 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Connected all rings
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Connected all trees
x3005c0s7b1n0:27613:27628 [0] NCCL INFO MSCCL_XML_FILES set by environment to /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27613:27628 [0] NCCL INFO MSCCL: Parsing algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Parsed MSCCL Algorithm /home/yuke/ncclPG/CCL-LYD/msccl_tools_lyd/examples/xml/allreduce_binary_tree_p_gpu01_2nodes_2gpus_channel1_reverse_chunk128.xml successfully.
x3005c0s7b1n0:27613:27628 [0] NCCL INFO Connected 1 MSCCL algorithms
x3005c0s7b1n0:27613:27628 [0] NCCL INFO NCCL_NTHREADS set by environment to 512.
x3005c0s7b1n0:27613:27628 [0] NCCL INFO NCCL_PROTO set by environment to Simple
x3005c0s7b1n0:27613:27628 [0] NCCL INFO NCCL_ALGO set by environment to MSCCL,TREE,RING
x3005c0s7b1n0:27613:27628 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64 | 8/8/512
x3005c0s7b1n0:27613:27628 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
x3005c0s7b0n0:24448:24460 [0] NCCL INFO comm 0x14ca25cb5010 rank 0 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
#
#                                                              out-of-place                       in-place          
#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
x3005c0s7b0n0:24448:24448 [0] NCCL INFO Launch mode Parallel
x3005c0s7b1n0:27613:27628 [0] NCCL INFO comm 0x1498c07d7010 rank 1 nranks 2 cudaDev 0 busId 7000 - Init COMPLETE
        1024           256     float     sum      -1    596.6    0.00    0.00    512    599.3    0.00    0.00      0
        2048           512     float     sum      -1    586.6    0.00    0.00   1024    585.9    0.00    0.00      0
        4096          1024     float     sum      -1    588.7    0.01    0.01   2048    587.6    0.01    0.01      0
        8192          2048     float     sum      -1    587.6    0.01    0.01   4096    588.0    0.01    0.01      0
       16384          4096     float     sum      -1    590.9    0.03    0.03   8192    617.2    0.03    0.03      0
       32768          8192     float     sum      -1    591.7    0.06    0.06  16384    591.4    0.06    0.06      0
       65536         16384     float     sum      -1    588.4    0.11    0.11  32768    588.4    0.11    0.11      0
      131072         32768     float     sum      -1    591.5    0.22    0.22  65536    592.2    0.22    0.22      0
      262144         65536     float     sum      -1    598.8    0.44    0.44  131072    598.3    0.44    0.44      0
      524288        131072     float     sum      -1    837.4    0.63    0.63  262144    838.3    0.63    0.63      0
     1048576        262144     float     sum      -1    881.0    1.19    1.19  524288    880.5    1.19    1.19      0
     2097152        524288     float     sum      -1    969.4    2.16    2.16  1.04858e+06    969.5    2.16    2.16      0
     4194304       1048576     float     sum      -1   1129.6    3.71    3.71  2.09715e+06   1119.0    3.75    3.75      0
     8388608       2097152     float     sum      -1   1428.1    5.87    5.87  4.1943e+06   1428.6    5.87    5.87      0
    16777216       4194304     float     sum      -1   2386.1    7.03    7.03  8.38861e+06   2387.0    7.03    7.03      0
    33554432       8388608     float     sum      -1   4003.0    8.38    8.38  1.67772e+07   4003.8    8.38    8.38      0
    67108864      16777216     float     sum      -1   7203.8    9.32    9.32  3.35544e+07   7202.0    9.32    9.32      0
   134217728      33554432     float     sum      -1    14252    9.42    9.42  6.71088e+07    14253    9.42    9.42      0
   268435456      67108864     float     sum      -1    28319    9.48    9.48  1.34218e+08    28322    9.48    9.48      0
   536870912     134217728     float     sum      -1    56456    9.51    9.51  2.68435e+08    56469    9.51    9.51      0
x3005c0s7b0n0:24448:24448 [0] NCCL INFO comm 0x14ca25cb5010 rank 0 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
x3005c0s7b1n0:27613:27613 [0] NCCL INFO comm 0x1498c07d7010 rank 1 nranks 2 cudaDev 0 busId 7000 - Destroy COMPLETE
# Out of bounds values : 40 FAILED
# Avg bus bandwidth    : 3.37976 
#

